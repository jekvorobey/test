(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{"+9Ea":function(t,e,s){},Oq4R:function(t,e,s){"use strict";s.r(e);var a=s("+gqB"),n=s("45Ux"),i=s("6AGh"),o=s("L2JU"),r=s("Q2AE"),u=s("rBTT"),c=s("2B0T"),l=s("YYEX"),_=s("Aaqd"),v=s("nfjx"),b=s("3eXy"),h=s("QmAe"),d=s("4mC1"),w=s("GyY8"),p=s("q5Zp");s("+9Ea");function f(t,e,s,a,n,i,o){try{var r=t[i](o),u=r.value}catch(t){return void s(t)}r.done?e(u):Promise.resolve(u).then(a,n)}function g(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function m(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?g(Object(s),!0).forEach((function(e){C(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function C(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var y="".concat(u.NAME,"/").concat(c.e),O={name:"bonuses",mixins:[v.a],components:{VPagination:a.a,InfoRow:n.a,ShowMoreButton:i.a},metaInfo:function(){var t=this.pageTitle,e=this.activePage;return{title:e>1?"".concat(t," – страница ").concat(e):t}},data:function(){return{showMore:!1}},computed:m(m(m(m({},Object(o.d)([r.g])),Object(o.d)(y,[c.d,c.a,c.b,c.c])),Object(o.c)(y,[_.a])),{},{nextDebDate:function(){var t=(this[c.c]||{}).next_debit_date;return t&&Object(h.g)(t).toLocaleDateString(this[r.g],w.f)},bonuses:function(){var t=this;return(this[c.d]||[]).map((function(e){var s=e.created_at&&Object(h.g)(e.created_at).toLocaleDateString(t[r.g],w.f),a=t.$t("bonusStatus.".concat(e.status));return m(m({},e),{},{statusString:a,date:s})}))},pageTitle:function(){return this.$t("profile.routes.".concat(this.$route.name))},isTablet:function(){return this.$mq.tablet}}),methods:m(m({},Object(o.b)(y,[l.a])),{},{onShowMore:function(){this.showMore=!0,this.$router.replace({path:this.$route.path,query:m(m({},this.$route.query),{},{page:this[c.a]+1})})},onPageChanged:function(t){this.showMore=!1,this.$router.push({path:this.$route.path,query:m(m({},this.$route.query),{},{page:t>d.b?t:void 0})})}}),beforeRouteEnter:function(t,e,s){var a=t.fullPath,n=t.query.page,i=void 0===n?d.b:n;b.$store.state[u.NAME][c.e].loadPath===a?s():(b.$progress.start(),b.$store.dispatch("".concat(y,"/").concat(l.a),{page:i}).then((function(){b.$store.dispatch("".concat(y,"/").concat(l.b),a),s((function(){b.$progress.finish()}))})).catch((function(){b.$progress.fail(),s()})))},beforeRouteUpdate:function(t,e,s){var a,n=this;return(a=regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.query.page,i=void 0===a?d.b:a,e.prev=1,n.$progress.start(),e.next=5,n[l.a]({page:i,showMore:n.showMore});case 5:n.$progress.finish(),s(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),n.$progress.fail(),s(!1);case 13:n.showMore=!1;case 14:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,e=arguments;return new Promise((function(s,n){var i=a.apply(t,e);function o(t){f(i,s,n,o,r,"next",t)}function r(t){f(i,s,n,o,r,"throw",t)}o(void 0)}))})()},created:function(){this.bonusStatus=p.b}},$=s("KHd+"),j=Object($.a)(O,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section bonuses-view"},[s("h2",{staticClass:"bonuses-view__hl"},[t._v("\n        "+t._s(t.pageTitle)+"\n    ")]),t._v(" "),s("div",{staticClass:"bonuses-view__panel"},[s("div",{staticClass:"bonuses-view__panel-col"},[s("div",{staticClass:"text-grey bonuses-view__panel-label"},[t._v("Ваши бонусы")]),t._v(" "),s("div",{staticClass:"text-bold bonuses-view__panel-count"},[t._v(t._s(t.info.available))])]),t._v(" "),s("div",{staticClass:"bonuses-view__panel-col"},[s("div",{staticClass:"text-grey bonuses-view__panel-label"},[t._v("\n                Ближайшее сгорание:\n                "),t.info.next_debit_date?[t._v("\n                    "+t._s(t.nextDebDate)+"\n                ")]:[t._v("нет")]],2),t._v(" "),t.info.next_debit_sum?s("div",{staticClass:"text-medium bonuses-view__panel-burn"},[t._v("\n                "+t._s(t.info.next_debit_sum)+" бонусов\n            ")]):t._e()]),t._v(" "),s("div",{staticClass:"bonuses-view__panel-col"},[s("div",{staticClass:"text-bold bonuses-view__panel-amount"},[t._v("1 бонус = "+t._s(t.info.bonus_per_rub)+" рубль")]),t._v(" "),s("div",[s("router-link",{attrs:{to:"/bonuses"}},[t._v("Подробнее о бонусной программе")])],1)])]),t._v(" "),t.isTablet?s("ul",{staticClass:"bonuses-view__list"},t._l(t.bonuses,(function(e){return s("li",{key:e.id,staticClass:"bonuses-view__list-item",attrs:{tabindex:"0"}},[s("info-row",{staticClass:"bonuses-view__list-item-row",attrs:{name:"Заказ / событие",value:e.name}}),t._v(" "),s("info-row",{staticClass:"bonuses-view__list-item-row",attrs:{name:"Списано",value:e.status===t.bonusStatus.TAKEN?e.value:0}}),t._v(" "),s("info-row",{staticClass:"bonuses-view__list-item-row",attrs:{name:"Начислено",value:e.status!==t.bonusStatus.TAKEN?e.value:0}}),t._v(" "),s("info-row",{staticClass:"bonuses-view__list-item-row",attrs:{name:"Статус",value:e.statusString}}),t._v(" "),s("info-row",{staticClass:"bonuses-view__list-item-row",attrs:{name:"Дата",value:e.date}})],1)})),0):s("div",{staticClass:"container container--tablet-lg"},[s("h3",{staticClass:"bonuses-view__section-hl"},[t._v("Бонусная программа")]),t._v(" "),s("table",{staticClass:"bonuses-view__table"},[t._m(0),t._v(" "),s("thead",{staticClass:"bonuses-view__table-head"},[s("tr",{staticClass:"bonuses-view__table-tr bonuses-view__table-tr--header"},[s("th",{staticClass:"bonuses-view__table-th"},[t._v("Заказ / событие")]),t._v(" "),s("th",{staticClass:"bonuses-view__table-th"},[t._v("Списано всего"),s("br"),t._v(t._s(t.info.debit_all))]),t._v(" "),s("th",{staticClass:"bonuses-view__table-th"},[t._v("Начислено всего"),s("br"),t._v(t._s(t.info.received_all))]),t._v(" "),s("th",{staticClass:"bonuses-view__table-th"},[t._v("Статус")]),t._v(" "),s("th",{staticClass:"bonuses-view__table-th"},[t._v("Дата")])])]),t._v(" "),s("transition-group",{staticClass:"bonuses-view__table-body",attrs:{tag:"tbody",name:"fade-in",appear:""}},t._l(t.bonuses,(function(e){return s("tr",{key:e.id,staticClass:"bonuses-view__table-tr"},[s("td",{staticClass:"bonuses-view__table-td"},[t._v(t._s(e.name))]),t._v(" "),s("td",{staticClass:"bonuses-view__table-td"},[t._v("\n                        "+t._s(e.status===t.bonusStatus.TAKEN?e.value:"")+"\n                    ")]),t._v(" "),s("td",{staticClass:"bonuses-view__table-td"},[t._v("\n                        "+t._s(e.status!==t.bonusStatus.TAKEN?e.value:"")+"\n                    ")]),t._v(" "),s("td",{staticClass:"bonuses-view__table-td"},[t._v(t._s(e.statusString))]),t._v(" "),s("td",{staticClass:"bonuses-view__table-td"},[t._v(t._s(e.date))])])})),0)],1)]),t._v(" "),t.pagesCount>1?s("div",{staticClass:"bonuses-view__controls"},[s("div",{staticClass:"container container--tablet-lg"},[t.activePage!==t.pagesCount?s("show-more-button",{attrs:{"btn-class":"btn--outline bonuses-view__controls-btn"},on:{click:t.onShowMore}},[t._v("\n                Показать ещё\n            ")]):t._e(),t._v(" "),s("v-pagination",{attrs:{value:t.activePage,"page-count":t.pagesCount},on:{input:t.onPageChanged}})],1)]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("colgroup",[e("col",{attrs:{width:"25%"}}),this._v(" "),e("col",{attrs:{width:"20%"}}),this._v(" "),e("col",{attrs:{width:"20%"}}),this._v(" "),e("col",{attrs:{width:"20%"}}),this._v(" "),e("col",{attrs:{width:"15%"}})])}],!1,null,null,null);e.default=j.exports}}]);