(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{LUyO:function(e,t,r){"use strict";r.r(t);var a=r("NDiG"),i=r("7cXU"),n=r("i2Ud"),o=r("KQVR"),s=r("YNzt"),d=r("45Ux"),l=r("PZpB"),c=r("XJM6"),u=r("3eXy"),v=r("L2JU"),f=r("Q2AE"),_=r("rBTT"),p=r("JM0x"),h=r("5GyW"),m=r("4kxs"),w=r("8TZ/"),b=r("0CxO");function y(e,t,r,a){return t?e+function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:", ";return t?"".concat(e).concat(r):e}(t,r,a):e}var g,C=r("P1RU"),P=r("DpYB"),O=r("zVjp"),D=r("tCqp");r("PnIt"),r("SRJT"),r.p,r.p,r.p,r.p;function k(e,t,r,a,i,n,o){try{var s=e[n](o),d=s.value}catch(e){return void r(e)}s.done?t(d):Promise.resolve(d).then(a,i)}function j(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var n=e.apply(t,r);function o(e){k(n,a,i,o,s,"next",e)}function s(e){k(n,a,i,o,s,"throw",e)}o(void 0)}))}}function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var x="".concat(_.NAME,"/").concat(h.c);function R(e,t,r,a){e[p.a]([{name:e.$t("profile.routes.Orders"),to:{name:"Orders"}},{name:e.$t("profile.format.order",{id:a}),to:{name:t,params:r}}])}var U={name:"order-details",components:{VSvg:a.a,VLink:i.a,VButton:n.a,VInput:o.a,Price:s.a,InfoPanel:l.a,InfoRow:d.a,PackageProductCard:c.a},data:function(){return{isDisabled:!1}},computed:$($($({},Object(v.d)([f.f])),Object(v.d)(x,(g={},S(g,h.d,(function(e){return e[h.f][h.d]||{}})),S(g,h.b,(function(e){return e[h.f][h.b]||[]})),g))),{},{canPay:function(){var e=this[h.d],t=e.payment_status,r=void 0===t?3:t,a=e.payments,i=void 0===a?[]:a;return r===P.b.NOT_PAID&&0!==i.length},orderStatusClass:function(){return Object(C.b)(this.order.status,this.order.canceled)},deliveryMethod:function(){var e=this[h.b];if(1===e.length){var t=e[0].delivery_method;return this.formatDeliveryMethod(t)}},deliveryMethodId:function(){var e=this[h.b];if(1===e.length)return e[0].delivery_method},deliveryDate:function(){var e=this[h.b];if(1===e.length){var t=e[0].delivery_at;return this.formatDate(t)}},deliveryAddress:function(){var e=this[h.b];if(1===e.length)return this.formatAddress(e[0])},deliveryPoint:function(){var e=this[h.b];if(1===e.length)return e[0].point},orderStatus:function(){var e=this[h.d].status;return this.$t("orderStatus.".concat(e))},backUrl:function(){return{name:"Orders"}}}),methods:$($($($({},Object(v.b)(_.NAME,[p.a])),Object(v.b)(x,[m.c,m.f,m.d,m.e])),Object(v.b)(w.c,[b.h])),{},{onContinuePayment:function(e){var t=this;return j(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a="".concat(document.location.origin,"/thank-you"),r.next=3,t[m.d]({id:e,backUrl:a});case 3:i=r.sent,document.location.href=i;case 5:case"end":return r.stop()}}),r)})))()},onRepeatOrder:function(e){var t=this;return j(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.isDisabled=!0,r.next=4,t[m.e](e);case 4:return r.next=6,t[b.h]();case 6:t.$router.push({path:"/cart"}),t.isDisabled=!1,r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),t.isDisabled=!1;case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},getDeliveryStatusClass:function(e){return Object(C.a)(e)},formatDeliveryStatus:function(e){return this.$t("deliveryStatus.".concat(e))},formatAddress:function(e){var t=e.delivery_address,r=e.point;return t&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.area,r=e.city,a=(e.flat,e.block),i=(e.floor,e.house),n=(e.porch,e.region),o=e.street,s="";return s=y(s,n),s=y(s,t),r!==n&&(s=y(s,r)),s=y(s,o),s=y(s,i,a||!1),s=y(s,a,!1)}(t)||r.address.address_string},formatDate:function(e){if("string"==typeof e)return new Date(e.split(" ")[0]).toLocaleDateString(this[f.f],O.b)},formatPackageCount:function(e){return this.$t("profile.format.packageCount",{n:e})},formatDeliveryMethod:function(e){return this.$t("deliveryMethod.".concat(e))}}),beforeRouteEnter:function(e,t,r){var a=e.fullPath,i=e.name,n=e.params,o=u.$store.state[_.NAME][h.c],s=o.loadPath,d=o.orderDetails;s===a?r((function(e){return R(e,i,n,d.order.number)})):(u.$progress.start(),u.$store.dispatch("".concat(x,"/").concat(m.c),n.orderId).then((function(e){var t=e.number;u.$store.dispatch("".concat(x,"/").concat(m.f),a),r((function(e){u.$progress.finish(),R(e,i,n,t)}))})).catch((function(e){return r((function(e){u.$progress.fail(),R(e,i,n)}))})))},beforeRouteUpdate:function(e,t,r){var a=this,i=e.name,n=e.params;this.$progress.start(),this[m.c](n.orderId).then((function(e){var t=e.number;a.$progress.finish(),R(a,i,n,t)})).catch((function(e){a.$progress.fail(),R(a,i,n)})),r()},beforeRouteLeave:function(e,t,r){this[p.a]([]),r()},beforeMount:function(){this.deliveryMethods=D.e}},A=r("KHd+"),I=Object(A.a)(U,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"section order-details-view"},[r("div",{staticClass:"container container--tablet-lg"},[r("v-link",{staticClass:"order-details-view__back-link",attrs:{to:e.backUrl}},[r("v-svg",{attrs:{modifier:"icon--rotate-deg90",name:"arrow-small",width:"24",height:"24"}}),e._v(" Назад ко всем\n            заказам\n        ")],1),e._v(" "),r("h2",{staticClass:"order-details-view__hl"},[e._v(e._s(e.$t("profile.format.order",{id:e.order.number})))]),e._v(" "),r("div",{staticClass:"order-details-view__details"},[r("div",{staticClass:"order-details-view__details-info"},[r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Сумма"}},[r("price",e._b({staticClass:"text-medium"},"price",e.order.price,!1))],1),e._v(" "),e.order.delivery_price?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Доставка"}},[r("price",e._b({staticClass:"text-medium"},"price",e.order.delivery_price,!1))],1):e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",class:e.orderStatusClass,attrs:{name:"Статус заказа",value:e.orderStatus}}),e._v(" "),e.deliveryMethod?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Способ доставки",value:e.deliveryMethod}}):e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Дата заказа",value:e.formatDate(e.order.created_at)}}),e._v(" "),e.deliveryDate?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Дата доставки",value:e.deliveryDate}}):e._e(),e._v(" "),e.deliveryPoint&&e.deliveryMethodId===e.deliveryMethods.PICKUP?[r("br"),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Наименование ПВЗ",value:e.deliveryPoint.name}}),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Телефон",value:e.deliveryPoint.phone}}),e._v(" "),e.deliveryPoint.schedule?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Время работы"}},e._l(e.deliveryPoint.schedule,(function(t,a){return r("div",{key:t.id},[e._v("\n                            "+e._s(t.title)+"\n                            "+e._s(t.time)),a!==e.deliveryPoint.schedule.length-1?[e._v(", ")]:e._e()],2)})),0):e._e()]:e._e(),e._v(" "),e.deliveryAddress?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Адрес доставки",value:e.deliveryAddress}}):e._e()],2),e._v(" "),r("div",{staticClass:"order-details-view__details-controls"},[e.canPay?e._l(e.order.payments,(function(t){return r("v-button",{key:t.id,staticClass:"order-details-view__details-controls-btn",attrs:{disabled:e.isDisabled},on:{click:function(r){return e.onContinuePayment(e.order.id,t.id)}}},[e._v("\n                        Оплатить заказ\n                    ")])})):e._e(),e._v(" "),r("v-button",{staticClass:"btn--outline order-details-view__details-controls-btn",attrs:{disabled:e.isDisabled},on:{click:function(t){return t.stopPropagation(),e.onRepeatOrder(e.order.id)}}},[e._v("Повторить заказ")])],2)])],1),e._v(" "),e._l(e.deliveries,(function(t){return r("info-panel",{key:t.number,staticClass:"order-details-view__panel",attrs:{header:"Доставка №"+t.number}},[r("div",{staticClass:"container container--tablet-lg"},[e.deliveries.length>1?[r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Способ доставки",value:e.formatDeliveryMethod(t.delivery_method)}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Дата доставки",value:e.formatDate(t.delivery_at)}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",class:e.getDeliveryStatusClass(t.status),attrs:{name:"Статус доставки",value:e.formatDeliveryStatus(t.status)}}),e._v(" "),t.point&&t.delivery_method===e.deliveryMethods.PICKUP?[r("br"),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Наименование ПВЗ",value:t.point.name}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Телефон",value:t.point.phone}}),e._v(" "),t.point.schedule?r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Время работы"}},e._l(t.point.schedule,(function(a,i){return r("div",{key:a.id},[e._v("\n                            "+e._s(a.title)+"\n                            "+e._s(a.time)),i!==t.point.schedule.length-1?[e._v(", ")]:e._e()],2)})),0):e._e()]:e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Адрес доставки",value:e.formatAddress(t)}})]:e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Количество коробок",value:e.formatPackageCount(t.package_count)}}),e._v(" "),r("ul",{staticClass:"order-details-view__panel-list"},e._l(t.products,(function(e){return r("package-product-card",{key:e.id,staticClass:"order-details-view__panel-item",attrs:{name:e.name,image:e.image,price:e.price,"old-price":e.cost,count:e.qty}})})),1)],2)])}))],2)}),[],!1,null,null,null);t.default=I.exports},SRJT:function(e,t,r){}}]);