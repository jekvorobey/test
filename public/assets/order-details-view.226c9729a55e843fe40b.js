(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{LUyO:function(e,t,r){"use strict";r.r(t);var a=r("NDiG"),i=r("7cXU"),s=r("i2Ud"),n=r("KQVR"),o=r("YNzt"),c=r("45Ux"),d=r("PZpB"),l=r("XJM6"),u=r("jYNS"),v=(r("gB8C"),r("kTJR"),{name:"order-masterclass-card",components:{VSvg:a.a,VLink:i.a,VPicture:u.a,Price:o.a},props:{name:{type:String,required:!0},type:{type:String,required:!0},note:{type:String},href:{type:String},image:{type:[String,Object]},date:{type:[String,Date]},author:{type:String},additions:{type:String},price:{type:Object},oldPrice:{type:Object},count:{type:Number,default:1},isSmall:{type:Boolean,default:!1}},computed:{isTablet:function(){return this.$mq.tablet}}}),_=r("KHd+"),m=Object(_.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"order-masterclass-card",class:{"order-masterclass-card--small":e.isSmall}},[r("router-link",{staticClass:"order-masterclass-card__img",attrs:{to:e.href}},[e.image?r("v-picture",[e._t("default")],2):r("v-svg",{attrs:{id:"order-masterclass-card-empty",name:"logo",width:"48",height:"48"}})],1),e._v(" "),r("div",{staticClass:"order-masterclass-card__body"},[r("v-link",{staticClass:"order-masterclass-card__body-name",attrs:{to:e.href}},[r("div",[e._v(e._s(e.name))]),e._v(" "),e.note?r("div",[e._v("("+e._s(e.note)+")")]):e._e()]),e._v(" "),r("div",{staticClass:"order-masterclass-card__body-count"},[e._v(e._s(e.count)+" шт.")]),e._v(" "),r("div",{staticClass:"order-masterclass-card__body-prices"},[r("price",e._b({staticClass:"text-bold order-masterclass-card__body-price"},"price",e.price,!1)),e._v(" "),r("price",e._b({directives:[{name:"show",rawName:"v-show",value:e.oldPrice,expression:"oldPrice"}],staticClass:"text-grey text-strike order-masterclass-card__body-price order-masterclass-card__body-price--old"},"price",e.oldPrice,!1))],1),e._v(" "),r("div",{staticClass:"text-grey text-sm order-masterclass-card__body-info"},[r("div",[e._v(e._s(e.additions))]),e._v(" "),r("div",[e._v(e._s(e.date)+", "+e._s(e.author))])])],1)],1)}),[],!1,null,null,null).exports,f=r("3eXy"),p=r("L2JU"),h=r("Q2AE"),b=r("rBTT"),g=r("JM0x"),w=r("5GyW"),y=r("4kxs"),C=r("8TZ/"),P=r("0CxO"),k=r("2JJK"),O=r("tCqp"),j=r("DpYB"),D=r("GyY8"),S=r("zVjp");function x(e,t,r,a){return t?e+function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:", ";return t?"".concat(e).concat(r):e}(t,r,a):e}var $,M=r("W6hq"),E=r("aXGN"),I=r("P1RU");r("PnIt"),r("SRJT");function R(e,t,r,a,i,s,n){try{var o=e[s](n),c=o.value}catch(e){return void r(e)}o.done?t(c):Promise.resolve(c).then(a,i)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var s=e.apply(t,r);function n(e){R(s,a,i,n,o,"next",e)}function o(e){R(s,a,i,n,o,"throw",e)}n(void 0)}))}}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var J="".concat(b.NAME,"/").concat(w.c);function V(e,t,r,a){e[g.a]([{name:e.$t("profile.routes.Orders"),to:{name:"Orders"}},{name:e.$t("profile.format.order",{id:a}),to:{name:t,params:r}}])}var q={name:"order-details",components:{VSvg:a.a,VLink:i.a,VButton:s.a,VInput:n.a,Price:o.a,InfoPanel:d.a,InfoRow:c.a,PackageProductCard:l.a,OrderMasterclassCard:m},data:function(){return{isDisabled:!1}},computed:U(U(U({},Object(p.d)([h.g])),Object(p.d)(J,($={},A($,w.d,(function(e){return e[w.f]&&e[w.f][w.d]||{}})),A($,w.b,(function(e){return e[w.f]&&e[w.f][w.b]||[]})),A($,w.j,(function(e){return e[w.f]&&e[w.f][w.j]||[]})),$))),{},{receiverEmail:function(){return(this[w.d]||{}).receiver_email},items:function(){var e=this;return(this[w.j]||[]).map((function(t){var r=new Date("".concat(t.nearestDate," ").concat(t.nearestTimeFrom)),a=r.toLocaleString(e[h.g],D.b),i=r.toLocaleString(e[h.g],D.d),s="".concat(a,", ").concat(i),n=Object(M.g)(t.code),o="Входной билет ".concat(t.ticketTypeName),c=t.speakers&&t.speakers[0],d=c&&"".concat(c.firstName," ").concat(c.lastName,", ").concat(c.profession),l=t.participants||[],u="Участники: ".concat(l.map((function(e){return"".concat(e.firstName," ").concat(e.lastName)})).join(", ")),v=t.image&&Object(E.c)(400,240,t.image.id),_=t.image&&{webp:Object(E.c)(400,240,t.image.id,k.fileExtension.image.WEBP),orig:Object(E.c)(400,240,t.image.id)},m=t.image&&{webp:Object(E.c)(425,320,t.image.id,k.fileExtension.image.WEBP),orig:Object(E.c)(425,320,t.image.id)};return U(U({},t),{},{note:o,author:d,additions:u,url:n,dateTime:s,desktopImg:_,mobileImg:m,defaultImg:v})}))},canPay:function(){var e=this[w.d],t=e.payment_status,r=void 0===t?3:t,a=e.payments,i=void 0===a?[]:a;return r===j.c.NOT_PAID&&0!==i.length},orderStatusClass:function(){return Object(I.c)(this.order.status,this.order.canceled)},deliveryMethod:function(){var e=this[w.b];if(1===e.length){var t=e[0].delivery_method;return this.formatDeliveryMethod(t)}},deliveryMethodId:function(){var e=this[w.b];if(1===e.length)return e[0].delivery_method},deliveryDate:function(){var e=this[w.b];if(1===e.length){var t=e[0].delivery_at;return this.formatDate(t)}},deliveryAddress:function(){var e=this[w.b];if(1===e.length)return this.formatAddress(e[0])},deliveryPoint:function(){var e=this[w.b];if(1===e.length)return e[0].point},orderStatus:function(){var e=this[w.d].status;return this.$t("orderStatus.".concat(e))},backUrl:function(){return{name:"Orders"}},isTablet:function(){return this.$mq.tablet}}),methods:U(U(U(U({},Object(p.b)(b.NAME,[g.a])),Object(p.b)(J,[y.c,y.f,y.d,y.e])),Object(p.b)(C.c,[P.k])),{},{onContinuePayment:function(e){var t=this;return N(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a="".concat(document.location.origin,"/thank-you"),r.next=3,t[y.d]({id:e,backUrl:a});case 3:i=r.sent,document.location.href=i;case 5:case"end":return r.stop()}}),r)})))()},onRepeatOrder:function(e){var t=this;return N(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.isDisabled=!0,r.next=4,t[y.e](e);case 4:return r.next=6,t[P.k]();case 6:t.$router.push({path:"/cart"}),t.isDisabled=!1,r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),t.isDisabled=!1;case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},getDeliveryStatusClass:function(e){return Object(I.a)(e)},formatDeliveryStatus:function(e){return this.$t("deliveryStatus.".concat(e))},formatAddress:function(e){var t=e.delivery_address,r=e.point;return t&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.area,r=e.city,a=(e.flat,e.block),i=(e.floor,e.house),s=(e.porch,e.region),n=e.street,o="";return o=x(o,s),o=x(o,t),r!==s&&(o=x(o,r)),o=x(o,n),o=x(o,i,a||!1),o=x(o,a,!1)}(t)||r.address.address_string},formatDate:function(e){if("string"==typeof e)return new Date(e.split(" ")[0]).toLocaleDateString(this[h.g],S.b)},formatPackageCount:function(e){return this.$t("profile.format.packageCount",{n:e})},formatDeliveryMethod:function(e){return this.$t("deliveryMethod.".concat(e))}}),beforeRouteEnter:function(e,t,r){var a=e.fullPath,i=e.name,s=e.params,n=f.$store.state[b.NAME][w.c],o=n.loadPath,c=n.orderDetails;o===a?r((function(e){return V(e,i,s,c.order.number)})):(f.$progress.start(),f.$store.dispatch("".concat(J,"/").concat(y.c),s.orderId).then((function(e){var t=e.number;f.$store.dispatch("".concat(J,"/").concat(y.f),a),r((function(e){f.$progress.finish(),V(e,i,s,t)}))})).catch((function(e){return r((function(e){f.$progress.fail(),V(e,i,s)}))})))},beforeRouteUpdate:function(e,t,r){var a=this,i=e.name,s=e.params;this.$progress.start(),this[y.c](s.orderId).then((function(e){var t=e.number;a.$progress.finish(),V(a,i,s,t)})).catch((function(e){a.$progress.fail(),V(a,i,s)})),r()},beforeRouteLeave:function(e,t,r){this[g.a]([]),r()},beforeMount:function(){this.deliveryMethods=O.e}},B=Object(_.a)(q,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"section order-details-view"},[r("div",{staticClass:"container container--tablet-lg"},[r("v-link",{staticClass:"order-details-view__back-link",attrs:{to:e.backUrl}},[r("v-svg",{attrs:{modifier:"icon--rotate-deg90",name:"arrow-small",width:"24",height:"24"}}),e._v(" Назад ко всем\n            заказам\n        ")],1),e._v(" "),r("h2",{staticClass:"order-details-view__hl"},[e._v(e._s(e.$t("profile.format.order",{id:e.order.number})))]),e._v(" "),r("div",{staticClass:"order-details-view__details"},[r("div",{staticClass:"order-details-view__details-info"},[r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Сумма"}},[r("price",e._b({staticClass:"text-medium"},"price",e.order.price,!1))],1),e._v(" "),e.order.delivery_price?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Доставка"}},[r("price",e._b({staticClass:"text-medium"},"price",e.order.delivery_price,!1))],1):e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",class:e.orderStatusClass,attrs:{name:"Статус заказа",value:e.orderStatus}}),e._v(" "),e.deliveryMethod?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Способ доставки",value:e.deliveryMethod}}):e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Дата заказа",value:e.formatDate(e.order.created_at)}}),e._v(" "),e.deliveryDate?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Дата доставки",value:e.deliveryDate}}):e._e(),e._v(" "),e.deliveryPoint&&e.deliveryMethodId===e.deliveryMethods.PICKUP?[r("br"),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Наименование ПВЗ",value:e.deliveryPoint.name}}),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Телефон",value:e.deliveryPoint.phone}}),e._v(" "),e.deliveryPoint.schedule?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Время работы"}},e._l(e.deliveryPoint.schedule,(function(t,a){return r("div",{key:t.id},[e._v("\n                            "+e._s(t.title)+"\n                            "+e._s(t.time)),a!==e.deliveryPoint.schedule.length-1?[e._v(", ")]:e._e()],2)})),0):e._e()]:e._e(),e._v(" "),e.deliveryAddress?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Адрес доставки",value:e.deliveryAddress}}):e._e(),e._v(" "),e.receiverEmail?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Email",value:e.receiverEmail}}):e._e()],2),e._v(" "),r("div",{staticClass:"order-details-view__details-controls"},[e.canPay?e._l(e.order.payments,(function(t){return r("v-button",{key:t.id,staticClass:"order-details-view__details-controls-btn",attrs:{disabled:e.isDisabled},on:{click:function(r){return e.onContinuePayment(e.order.id,t.id)}}},[e._v("\n                        Оплатить заказ\n                    ")])})):e._e(),e._v(" "),r("v-button",{staticClass:"btn--outline order-details-view__details-controls-btn",attrs:{disabled:e.isDisabled},on:{click:function(t){return t.stopPropagation(),e.onRepeatOrder(e.order.id)}}},[e._v("\n                    Повторить заказ\n                ")])],2)])],1),e._v(" "),e._l(e.deliveries,(function(t){return r("info-panel",{key:t.number,staticClass:"order-details-view__panel",attrs:{header:"Доставка №"+t.number}},[r("div",{staticClass:"container container--tablet-lg"},[e.deliveries.length>1?[r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Способ доставки",value:e.formatDeliveryMethod(t.delivery_method)}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Дата доставки",value:e.formatDate(t.delivery_at)}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",class:e.getDeliveryStatusClass(t.status),attrs:{name:"Статус доставки",value:e.formatDeliveryStatus(t.status)}}),e._v(" "),t.point&&t.delivery_method===e.deliveryMethods.PICKUP?[r("br"),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Наименование ПВЗ",value:t.point.name}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Телефон",value:t.point.phone}}),e._v(" "),t.point.schedule?r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Время работы"}},e._l(t.point.schedule,(function(a,i){return r("div",{key:a.id},[e._v("\n                            "+e._s(a.title)+"\n                            "+e._s(a.time)),i!==t.point.schedule.length-1?[e._v(", ")]:e._e()],2)})),0):e._e()]:e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Адрес доставки",value:e.formatAddress(t)}})]:e._e(),e._v(" "),t.package_count?r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Количество коробок",value:e.formatPackageCount(t.package_count)}}):e._e(),e._v(" "),r("ul",{staticClass:"order-details-view__panel-list"},e._l(t.products,(function(e){return r("package-product-card",{key:e.id,staticClass:"order-details-view__panel-item",attrs:{name:e.name,image:e.image,price:e.price,"old-price":e.cost,count:e.qty}})})),1)],2)])})),e._v(" "),e.items&&e.items.length>0?r("info-panel",{staticClass:"order-details-view__panel",attrs:{header:"Билеты"}},[r("div",{staticClass:"container container--tablet-lg"},[r("ul",{staticClass:"order-details-view__panel-list"},e._l(e.items,(function(t){return r("order-masterclass-card",{key:t.id,staticClass:"order-details-view__panel-item",attrs:{type:"masterclass",name:t.name,note:t.note,image:t.image,price:t.price,"old-price":t.oldPrice,date:t.dateTime,author:t.author,additions:t.additions,count:t.qty,href:t.url,"is-small":e.isTablet}},[r("source",{attrs:{"data-srcset":t.desktopImg.webp,type:"image/webp"}}),e._v(" "),r("source",{attrs:{"data-srcset":t.desktopImg.orig}}),e._v(" "),r("img",{staticClass:"blur-up lazyload v-picture__img",attrs:{"data-src":t.defaultImg,alt:""}})])})),1)])]):e._e()],2)}),[],!1,null,null,null);t.default=B.exports},SRJT:function(e,t,r){},kTJR:function(e,t,r){}}]);