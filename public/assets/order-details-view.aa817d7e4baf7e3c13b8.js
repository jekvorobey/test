(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{LUyO:function(e,t,r){"use strict";r.r(t);var a=r("NDiG"),i=r("7cXU"),n=r("i2Ud"),o=r("KQVR"),s=r("YNzt"),c=r("45Ux"),d=r("PZpB"),l=r("jYNS"),u=r("aXGN"),v=(r("wOvY"),{name:"package-product-card",components:{VSvg:a.a,VLink:i.a,VPicture:l.a,Price:s.a},props:{name:{type:String,required:!0},href:{type:String,default:"/"},image:{type:[String,Object]},price:{type:Object},oldPrice:{type:Object},count:{type:[String,Number],default:1}},computed:{quantity:function(){return Number(this.count)}},methods:{generateSourcePath:function(e,t,r,a){return Object(u.c)(e,t,r,a)}}}),f=r("KHd+"),p=Object(f.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"package-product-card"},[r("router-link",{staticClass:"package-product-card__img",attrs:{to:e.href}},[e.image?r("v-picture",{attrs:{image:e.image,alt:""},scopedSlots:e._u([{key:"source",fn:function(t){var a=t.image;return[r("source",{attrs:{"data-srcset":e.generateSourcePath(64,64,a.id,"webp"),type:"image/webp"}})]}},{key:"fallback",fn:function(t){var a=t.image,i=t.alt;return[r("img",{staticClass:"blur-up lazyload v-picture__img",attrs:{"data-src":e.generateSourcePath(64,64,a.id),alt:i}})]}}],null,!1,2109703504)}):r("v-svg",{attrs:{id:"package-product-card-empty",name:"logo",width:"48",height:"48"}})],1),e._v(" "),r("div",{staticClass:"package-product-card__body"},[r("v-link",{staticClass:"package-product-card__body-name",attrs:{to:e.href}},[e._v(e._s(e.name))]),e._v(" "),r("div",{staticClass:"package-product-card__body-count"},[e._v(e._s(e.quantity)+" шт")]),e._v(" "),r("div",{staticClass:"package-product-card__body-prices"},[r("price",e._b({staticClass:"text-bold package-product-card__body-price"},"price",e.price,!1)),e._v(" "),e.oldPrice&&e.oldPrice.value!==e.price.value?r("price",e._b({staticClass:"text-grey text-strike package-product-card__body-price--old"},"price",e.oldPrice,!1)):e._e()],1)],1)],1)}),[],!1,null,null,null).exports,_=r("3eXy"),m=r("L2JU"),h=r("Q2AE"),b=r("rBTT"),w=r("JM0x"),y=r("5GyW"),g=r("4kxs"),C=r("8TZ/"),P=r("0CxO");function k(e,t,r,a){return t?e+function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:", ";return t?"".concat(e).concat(r):e}(t,r,a):e}var O,D=r("P1RU"),j=r("DpYB"),S=r("zVjp"),$=r("tCqp");r("PnIt"),r("SRJT"),r.p,r.p,r.p,r.p;function x(e,t,r,a,i,n,o){try{var s=e[n](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(a,i)}function M(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var n=e.apply(t,r);function o(e){x(n,a,i,o,s,"next",e)}function s(e){x(n,a,i,o,s,"throw",e)}o(void 0)}))}}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var I="".concat(b.NAME,"/").concat(y.c);function N(e,t,r,a){e[w.a]([{name:e.$t("profile.routes.Orders"),to:{name:"Orders"}},{name:e.$t("profile.format.order",{id:a}),to:{name:t,params:r}}])}var E={name:"order-details",components:{VSvg:a.a,VLink:i.a,VButton:n.a,VInput:o.a,Price:s.a,InfoPanel:d.a,InfoRow:c.a,PackageProductCard:p},data:function(){return{isDisabled:!1}},computed:U(U(U({},Object(m.d)([h.f])),Object(m.d)(I,(O={},A(O,y.d,(function(e){return e[y.f][y.d]||{}})),A(O,y.b,(function(e){return e[y.f][y.b]||[]})),O))),{},{canPay:function(){var e=this[y.d],t=e.payment_status,r=void 0===t?3:t,a=e.payments,i=void 0===a?[]:a;return r===j.b.NOT_PAID&&0!==i.length},orderStatusClass:function(){return Object(D.b)(this.order.status,this.order.canceled)},deliveryMethod:function(){var e=this[y.b];if(1===e.length){var t=e[0].delivery_method;return this.formatDeliveryMethod(t)}},deliveryMethodId:function(){var e=this[y.b];if(1===e.length)return e[0].delivery_method},deliveryDate:function(){var e=this[y.b];if(1===e.length){var t=e[0].delivery_at;return this.formatDate(t)}},deliveryAddress:function(){var e=this[y.b];if(1===e.length)return this.formatAddress(e[0])},deliveryPoint:function(){var e=this[y.b];if(1===e.length)return e[0].point},orderStatus:function(){var e=this[y.d].status;return this.$t("orderStatus.".concat(e))},backUrl:function(){return{name:"Orders"}}}),methods:U(U(U(U({},Object(m.b)(b.NAME,[w.a])),Object(m.b)(I,[g.c,g.f,g.d,g.e])),Object(m.b)(C.c,[P.g])),{},{onContinuePayment:function(e){var t=this;return M(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a="".concat(document.location.origin,"/thank-you"),r.next=3,t[g.d]({id:e,backUrl:a});case 3:i=r.sent,document.location.href=i;case 5:case"end":return r.stop()}}),r)})))()},onRepeatOrder:function(e){var t=this;return M(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.isDisabled=!0,r.next=4,t[g.e](e);case 4:return r.next=6,t[P.g]();case 6:t.$router.push({path:"/cart"}),t.isDisabled=!1,r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),t.isDisabled=!1;case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},getDeliveryStatusClass:function(e){return Object(D.a)(e)},formatDeliveryStatus:function(e){return this.$t("deliveryStatus.".concat(e))},formatAddress:function(e){var t=e.delivery_address,r=e.point;return t&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.area,r=e.city,a=(e.flat,e.block),i=(e.floor,e.house),n=(e.porch,e.region),o=e.street,s="";return s=k(s,n),s=k(s,t),s=k(s,r),s=k(s,o),s=k(s,i,a),s=k(s,a,!1)}(t)||r.address.address_string},formatDate:function(e){if("string"==typeof e)return new Date(e.split(" ")[0]).toLocaleDateString(this[h.f],S.b)},formatPackageCount:function(e){return this.$t("profile.format.packageCount",{n:e})},formatDeliveryMethod:function(e){return this.$t("deliveryMethod.".concat(e))}}),beforeRouteEnter:function(e,t,r){var a=e.fullPath,i=e.name,n=e.params,o=_.$store.state[b.NAME][y.c],s=o.loadPath,c=o.orderDetails;s===a?r((function(e){return N(e,i,n,c.order.number)})):(_.$progress.start(),_.$store.dispatch("".concat(I,"/").concat(g.c),n.orderId).then((function(e){var t=e.number;_.$store.dispatch("".concat(I,"/").concat(g.f),a),r((function(e){_.$progress.finish(),N(e,i,n,t)}))})).catch((function(e){return r((function(e){_.$progress.fail(),N(e,i,n)}))})))},beforeRouteUpdate:function(e,t,r){var a=this,i=e.name,n=e.params;this.$progress.start(),this[g.c](n.orderId).then((function(e){var t=e.number;a.$progress.finish(),N(a,i,n,t)})).catch((function(e){a.$progress.fail(),N(a,i,n)})),r()},beforeRouteLeave:function(e,t,r){this[w.a]([]),r()},beforeMount:function(){this.deliveryMethods=$.e}},V=Object(f.a)(E,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"section order-details-view"},[r("div",{staticClass:"container container--tablet-lg"},[r("v-link",{staticClass:"order-details-view__back-link",attrs:{to:e.backUrl}},[r("v-svg",{attrs:{modifier:"icon--rotate-deg90",name:"arrow-small",width:"24",height:"24"}}),e._v(" Назад ко всем\n            заказам\n        ")],1),e._v(" "),r("h2",{staticClass:"order-details-view__hl"},[e._v(e._s(e.$t("profile.format.order",{id:e.order.number})))]),e._v(" "),r("div",{staticClass:"order-details-view__details"},[r("div",{staticClass:"order-details-view__details-info"},[r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Сумма"}},[r("price",e._b({staticClass:"text-bold"},"price",e.order.price,!1))],1),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",class:e.orderStatusClass,attrs:{name:"Статус заказа",value:e.orderStatus}}),e._v(" "),e.deliveryMethod?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Способ доставки",value:e.deliveryMethod}}):e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Дата заказа",value:e.formatDate(e.order.created_at)}}),e._v(" "),e.deliveryDate?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Дата доставки",value:e.deliveryDate}}):e._e(),e._v(" "),e.deliveryPoint&&e.deliveryMethodId===e.deliveryMethods.PICKUP?[r("br"),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Наименование ПВЗ",value:e.deliveryPoint.name}}),e._v(" "),r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Телефон",value:e.deliveryPoint.phone}}),e._v(" "),e.deliveryPoint.schedule?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Время работы"}},e._l(e.deliveryPoint.schedule,(function(t,a){return r("div",{key:t.id},[e._v("\n                            "+e._s(t.title)+"\n                            "+e._s(t.time)),a!==e.deliveryPoint.schedule.length-1?[e._v(", ")]:e._e()],2)})),0):e._e()]:e._e(),e._v(" "),e.deliveryAddress?r("info-row",{staticClass:"order-details-view__details-row",attrs:{name:"Адрес доставки",value:e.deliveryAddress}}):e._e()],2),e._v(" "),r("div",{staticClass:"order-details-view__details-controls"},[e.canPay?e._l(e.order.payments,(function(t){return r("v-button",{key:t.id,staticClass:"order-details-view__details-controls-btn",attrs:{disabled:e.isDisabled},on:{click:function(r){return e.onContinuePayment(e.order.id,t.id)}}},[e._v("\n                        Оплатить заказ\n                    ")])})):e._e(),e._v(" "),r("v-button",{staticClass:"btn--outline order-details-view__details-controls-btn",attrs:{disabled:e.isDisabled},on:{click:function(t){return t.stopPropagation(),e.onRepeatOrder(e.order.id)}}},[e._v("Повторить заказ")])],2)])],1),e._v(" "),e._l(e.deliveries,(function(t){return r("info-panel",{key:t.number,staticClass:"order-details-view__panel",attrs:{header:"Доставка №"+t.number}},[r("div",{staticClass:"container container--tablet-lg"},[e.deliveries.length>1?[r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Способ доставки",value:e.formatDeliveryMethod(t.delivery_method)}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Дата доставки",value:e.formatDate(t.delivery_at)}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",class:e.getDeliveryStatusClass(t.status),attrs:{name:"Статус доставки",value:e.formatDeliveryStatus(t.status)}}),e._v(" "),t.point&&t.delivery_method===e.deliveryMethods.PICKUP?[r("br"),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Наименование ПВЗ",value:t.point.name}}),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Телефон",value:t.point.phone}}),e._v(" "),t.point.schedule?r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Время работы"}},e._l(t.point.schedule,(function(a,i){return r("div",{key:a.id},[e._v("\n                            "+e._s(a.title)+"\n                            "+e._s(a.time)),i!==t.point.schedule.length-1?[e._v(", ")]:e._e()],2)})),0):e._e()]:e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Адрес доставки",value:e.formatAddress(t)}})]:e._e(),e._v(" "),r("info-row",{staticClass:"order-details-view__panel-row",attrs:{name:"Количество коробок",value:e.formatPackageCount(t.package_count)}}),e._v(" "),r("ul",{staticClass:"order-details-view__panel-list"},e._l(t.products,(function(e){return r("package-product-card",{key:e.id,staticClass:"order-details-view__panel-item",attrs:{name:e.name,image:e.image,price:e.price,"old-price":e.cost,count:e.qty}})})),1)],2)])}))],2)}),[],!1,null,null,null);t.default=V.exports},SRJT:function(e,t,r){},wOvY:function(e,t,r){}}]);