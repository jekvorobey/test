(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{HT8i:function(e,t,s){"use strict";s.r(t);var o=s("NDiG"),n=s("7cXU"),a=s("i2Ud"),i=s("nurM"),r=s("45Ux"),c=s("uy7R"),l=s("L2JU"),_=s("Q2AE"),d=s("55Sm"),v=s("jDKC"),p=s("rBTT"),u=s("8d0O"),m=s("GsIJ"),h=s("fpWb"),f=s("2JJK"),g=s("tCqp"),w=(s("GyY8"),s("QmAe")),b=s("3eXy");s("Mii2"),s("2CE6"),s("LZ6J"),s("Uh29");function C(e,t,s,o,n,a,i){try{var r=e[a](i),c=r.value}catch(e){return void s(e)}r.done?t(c):Promise.resolve(c).then(o,n)}function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function O(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(Object(s),!0).forEach((function(t){k(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function k(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var D="".concat(p.NAME,"/").concat(u.a),j={name:"promocodes",components:{VSvg:o.a,VLink:n.a,VButton:a.a,RadioSwitch:i.a,InfoRow:r.a,MessageModal:c.a},data:function(){var e=[{value:0,title:"Действующие"},{value:1,title:"Архив"}];return{selectedStatus:e[0].value,promocodeStatus:e,items:[]}},computed:O(O(O(O({},Object(l.d)([_.f])),Object(l.c)(D,[m.a])),Object(l.d)(d.b,{isMessageOpen:function(e){return e[d.a][f.modalName.profile.MESSAGE]&&e[d.a][f.modalName.profile.MESSAGE].open}})),{},{isTabletLg:function(){return this.$mq.tabletLg}}),methods:O(O(O({},Object(l.b)(d.b,[v.a])),Object(l.b)(D,[h.a])),{},{onStatusChanged:function(e){this.$router.replace({path:this.$route.path,query:{isArchive:e}})},setFilterValue:function(e){this.selectedStatus=Number(e)},onCopyCode:function(e,t){var s=Object(w.i)(t)?"Успешно скопировано":"Не удается скопировать";this[v.a]({name:f.modalName.general.NOTIFICATION,open:!0,state:{message:s}}),e.target.focus()},onToggleIsOpen:function(e){e.isOpen=!e.isOpen},onPromocodeRequest:function(){this[v.a]({name:f.modalName.profile.MESSAGE,open:!0,state:{themeCode:f.themeCodes.PROMOCODE}})}}),watch:k({},m.a,(function(e){this.items=e||[]})),beforeRouteEnter:function(e,t,s){var o=e.fullPath,n=e.query.isArchive,a=void 0===n?0:n,i=b.$store.state[p.NAME][u.a].loadPath;o===i?s((function(e){return e.setFilterValue(a)})):(b.$progress.start(),b.$store.dispatch("".concat(D,"/").concat(h.a),a).then((function(){b.$store.dispatch("".concat(D,"/").concat(h.b),o),s((function(e){e.setFilterValue(a),b.$progress.finish()}))})).catch((function(e){return s((function(e){b.$progress.fail()}))})))},beforeRouteUpdate:function(e,t,s){var o,n=this;return(o=regeneratorRuntime.mark((function o(){var a,i,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(a=e.query.isArchive,i=void 0===a?0:a,r=t.query.isArchive,i!=r){o.next=4;break}return o.abrupt("return",s());case 4:return o.prev=4,n.$progress.start(),o.next=8,n[h.a](i);case 8:n.$progress.finish(),s(),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(4),n.$progress.fail(),s(!1);case 16:case"end":return o.stop()}}),o,null,[[4,12]])})),function(){var e=this,t=arguments;return new Promise((function(s,n){var a=o.apply(e,t);function i(e){C(a,s,n,i,r,"next",e)}function r(e){C(a,s,n,i,r,"throw",e)}i(void 0)}))})()},created:function(){this.promocodeType=g.d,this.items=this[m.a]}},T=s("KHd+"),S=Object(T.a)(j,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"section promocodes-view"},[s("div",{staticClass:"container container--tablet-lg promocodes-view__header"},[s("h2",{staticClass:"promocodes-view__hl"},[e._v(e._s(e.$t("profile.routes."+e.$route.name)))]),e._v(" "),e.items&&e.items.length?s("radio-switch",{staticClass:"promocodes-view__switch",attrs:{value:e.selectedStatus,items:e.promocodeStatus,id:"promocode-switch","key-field":"value",name:"promocodeStatus"},on:{input:e.onStatusChanged}}):e.isTabletLg?e._e():s("button",{staticClass:"btn btn--outline",on:{click:e.onPromocodeRequest}},[e._v("\n            Запрос промокода\n        ")])],1),e._v(" "),e.items&&e.items.length?[s("div",{staticClass:"container container--tablet-lg"},[e.isTabletLg?e._e():s("table",{staticClass:"promocodes-view__table"},[e._m(0),e._v(" "),e._m(1),e._v(" "),s("transition-group",{staticClass:"promocodes-view__table-body",attrs:{tag:"tbody",name:"fade-in",appear:""}},e._l(e.items,(function(t){return s("tr",{key:t.code,staticClass:"promocodes-view__table-tr"},[s("td",{staticClass:"promocodes-view__table-td"},[e._v("\n                            "+e._s(t.code)+"  \n                            "),s("button",{staticClass:"promocodes-view__table-btn",on:{click:function(s){return e.onCopyCode(s,t.code)}}},[s("v-svg",{attrs:{name:"copy",width:"16",height:"16"}})],1)]),e._v(" "),s("td",{staticClass:"promocodes-view__table-td"},[!t.endDate&&t.startDate?[e._v("c")]:e._e(),e._v("\n                            "+e._s(t.startDate)+"\n                            "),t.startDate&&t.endDate||!t.startDate&&!t.endDate?[e._v("\n                                –\n                            ")]:e._e(),e._v(" "),!t.startDate&&t.endDate?[e._v("по")]:e._e(),e._v("\n                            "+e._s(t.endDate)+"\n                        ")],2),e._v(" "),s("td",{staticClass:"promocodes-view__table-td"},[t.discount?[e._v("\n                                "+e._s(t.discount)+"\n                            ")]:[e._v(" – ")]],2),e._v(" "),s("td",{staticClass:"promocodes-view__table-td"},[t.type!==e.promocodeType.PRODUCT?[e._v("Все товары")]:t.brands&&t.brands.items.length>0?s("div",{staticClass:"promocodes-view__category-panel"},[s("div",{staticClass:"promocodes-view__category-panel-header"},[s("button",{staticClass:"promocodes-view__category-panel-btn",on:{click:function(s){return e.onToggleIsOpen(t.brands)}}},[e._v("\n                                        Бренды:\n                                    ")]),e._v("\n                                     "),s("v-svg",{class:{"icon--rotate-deg180":t.brands.isOpen},attrs:{name:"arrow-down",width:"16",height:"16"}})],1),e._v(" "),t.brands.isOpen?s("ul",{staticClass:"promocodes-view__category-panel-list"},e._l(t.brands.items,(function(t){return s("li",{key:t.id},[e._v("\n                                        - "+e._s(t.name)+"\n                                    ")])})),0):e._e()]):t.categories&&t.categories.items.length>0?s("div",{staticClass:"promocodes-view__category-panel"},[s("div",{staticClass:"promocodes-view__category-panel-header"},[s("button",{staticClass:"promocodes-view__category-panel-btn",on:{click:function(s){return e.onToggleIsOpen(t.categories)}}},[e._v("\n                                        Категории:\n                                    ")]),e._v("\n                                     "),s("v-svg",{attrs:{name:"arrow-down",width:"16",height:"16"}})],1),e._v(" "),t.categories.isOpen?s("ul",{staticClass:"promocodes-view__category-panel-list"},e._l(t.categories.items,(function(t){return s("li",{key:t.id},[e._v("\n                                        - "+e._s(t.name)+"\n                                    ")])})),0):e._e()]):t.offers?e._l(Object.keys(t.offers),(function(o){return s("div",{key:o,staticClass:"promocodes-view__category-panel"},[s("div",{staticClass:"promocodes-view__category-panel-header"},[s("button",{staticClass:"promocodes-view__category-panel-btn",on:{click:function(s){return e.onToggleIsOpen(t.offers[o])}}},[e._v("\n                                        "+e._s(o)+":\n                                    ")]),e._v("\n                                     "),s("v-svg",{class:{"icon--rotate-deg180":t.offers[o].isOpen},attrs:{name:"arrow-down",width:"16",height:"16"}})],1),e._v(" "),t.offers[o].isOpen?s("ul",{staticClass:"promocodes-view__category-panel-list"},e._l(t.offers[o].items,(function(t){return s("li",{key:t.name},[e._v("\n                                        - "+e._s(t.name)+"\n                                    ")])})),0):e._e()])})):e._e()],2)])})),0)],1)]),e._v(" "),e.isTabletLg?s("ul",{staticClass:"promocodes-view__list"},e._l(e.promocodes,(function(t){return s("li",{key:t.id,staticClass:"container container--tablet-lg promocodes-view__list-item"},[s("info-row",{staticClass:"promocodes-view__list-item-row",attrs:{name:"Промокод"}},[e._v("\n                    "+e._s(t.code)+"  \n                    "),s("button",{staticClass:"promocodes-view__table-btn",on:{click:function(s){return e.onCopyCode(s,t.code)}}},[s("v-svg",{attrs:{name:"copy",width:"16",height:"16"}})],1)]),e._v(" "),s("info-row",{staticClass:"promocodes-view__list-item-row",attrs:{name:"Срок действия"}},[!t.endDate&&t.startDate?[e._v("c")]:e._e(),e._v("\n                    "+e._s(t.startDate)+"\n                    "),t.startDate&&t.endDate?[e._v("–")]:e._e(),e._v(" "),!t.startDate&&t.endDate?[e._v("по")]:e._e(),e._v("\n                    "+e._s(t.endDate)+"\n                ")],2),e._v(" "),s("info-row",{staticClass:"promocodes-view__list-item-row",attrs:{name:"Скидка",value:t.discount}}),e._v(" "),s("info-row",{staticClass:"promocodes-view__list-item-row",attrs:{name:"Категория товаров"}},[t.type!==e.promocodeType.PRODUCT?[e._v("Все товары")]:t.brands&&t.brands.items.length>0?s("div",{staticClass:"promocodes-view__category-panel"},[s("div",{staticClass:"promocodes-view__category-panel-header"},[s("button",{staticClass:"promocodes-view__category-panel-btn",on:{click:function(s){return e.onToggleIsOpen(t.brands)}}},[e._v("\n                                Бренды:\n                            ")]),e._v("\n                             "),s("v-svg",{class:{"icon--rotate-deg180":t.brands.isOpen},attrs:{name:"arrow-down",width:"16",height:"16"}})],1),e._v(" "),t.brands.isOpen?s("ul",{staticClass:"promocodes-view__category-panel-list"},e._l(t.brands.items,(function(t){return s("li",{key:t.id},[e._v("- "+e._s(t.name))])})),0):e._e()]):t.categories&&t.categories.items.length>0?s("div",{staticClass:"promocodes-view__category-panel"},[s("div",{staticClass:"promocodes-view__category-panel-header"},[s("button",{staticClass:"promocodes-view__category-panel-btn",on:{click:function(s){return e.onToggleIsOpen(t.categories)}}},[e._v("\n                                Категории:\n                            ")]),e._v("\n                             "),s("v-svg",{attrs:{name:"arrow-down",width:"16",height:"16"}})],1),e._v(" "),t.categories.isOpen?s("ul",{staticClass:"promocodes-view__category-panel-list"},e._l(t.categories.items,(function(t){return s("li",{key:t.id},[e._v("\n                                - "+e._s(t.name)+"\n                            ")])})),0):e._e()]):t.offers?e._l(Object.keys(t.offers),(function(o){return s("div",{key:o,staticClass:"promocodes-view__category-panel"},[s("div",{staticClass:"promocodes-view__category-panel-header"},[s("button",{staticClass:"promocodes-view__category-panel-btn",on:{click:function(s){return e.onToggleIsOpen(t.offers[o])}}},[e._v("\n                                "+e._s(o)+":\n                            ")]),e._v("\n                             "),s("v-svg",{class:{"icon--rotate-deg180":t.offers[o].isOpen},attrs:{name:"arrow-down",width:"16",height:"16"}})],1),e._v(" "),t.offers[o].isOpen?s("ul",{staticClass:"promocodes-view__category-panel-list"},e._l(t.offers[o].items,(function(t){return s("li",{key:t.name},[e._v("\n                                - "+e._s(t.name)+"\n                            ")])})),0):e._e()])})):e._e()],2)],1)})),0):e._e()]:s("div",{staticClass:"promocodes-view__attention"},[s("v-svg",{staticClass:"promocodes-view__attention-icon",attrs:{name:"info-middle",width:"24",height:"24"}}),e._v(" "),e._m(2),e._v(" "),s("button",{staticClass:"btn btn--outline promocodes-view__attention-btn",on:{click:e.onPromocodeRequest}},[e._v("\n            Запрос промокода\n        ")])],1),e._v(" "),s("transition",{attrs:{name:"fade"}},[e.$isServer||e.isMessageOpen?s("message-modal"):e._e()],1)],2)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("colgroup",[t("col",{attrs:{width:"25%"}}),this._v(" "),t("col",{attrs:{width:"25%"}}),this._v(" "),t("col",{attrs:{width:"15%"}}),this._v(" "),t("col",{attrs:{width:"35%"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("thead",{staticClass:"promocodes-view__table-head"},[t("tr",{staticClass:"promocodes-view__table-tr promocodes-view__table-tr--header"},[t("th",{staticClass:"promocodes-view__table-th"},[this._v("Промокод")]),this._v(" "),t("th",{staticClass:"promocodes-view__table-th"},[this._v("Срок действия")]),this._v(" "),t("th",{staticClass:"promocodes-view__table-th"},[this._v("Скидка")]),this._v(" "),t("th",{staticClass:"promocodes-view__table-th"},[this._v("Категория товаров")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"promocodes-view__attention-text"},[this._v("\n            У вас пока нет активных промо-кодов."),t("br"),this._v("\n            Воспользуйтесь функцией «Запросить промо-код» для привлечения аудитории к определенным продуктам или\n            категориям товаров.\n        ")])}],!1,null,null,null);t.default=S.exports},Uh29:function(e,t,s){}}]);