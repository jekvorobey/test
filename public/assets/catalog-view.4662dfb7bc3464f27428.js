(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"/Rcj":function(e,t,a){"use strict";a.r(t);var n,r=a("NDiG"),o=a("i2Ud"),i=(a("o3vK"),a("+gqB")),c=(a("nuHk"),a("pFko")),s=a("0OV/"),u=a("/Q9p"),l=a("BZIu"),g=a("Nlzp"),f={SET_ITEMS:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{items:[],range:0},a=t.items,n=t.range;e.items=a||[],e.range=n||0},SET_PARAMS:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.id,n=t.code;e.categoryId=a,e.categoryCode=n},SET_CATEGORIES:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.categories=t}};function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e,t,a,n,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void a(e)}c.done?t(s):Promise.resolve(s).then(n,r)}var d,v,_,h=(m(n={},"FETCH_CATEGORIES",(function(e){var t=e.commit;return Object(g.f)().then((function(e){return t("SET_CATEGORIES",e)})).catch((function(e){return l.$logger.error("FETCH_CATEGORIES error: ".concat(e)),[]}))})),m(n,"FETCH_ITEMS",(function(e,t){var a=e.commit;return Object(g.h)(t).then((function(e){a("SET_ITEMS",e),a("SET_PARAMS",t)})).catch((function(e){return l.$logger.error("FETCH_ITEMS error: ".concat(e)),[]}))})),m(n,"FETCH_CATALOG_DATA",(d=regeneratorRuntime.mark((function e(t,a){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,e.next=3,Promise.all([n("FETCH_CATEGORIES")]);case 3:return e.abrupt("return",n("FETCH_ITEMS",a));case 4:case"end":return e.stop()}}),e)})),v=function(){var e=this,t=arguments;return new Promise((function(a,n){var r=d.apply(e,t);function o(e){p(r,a,n,o,i,"next",e)}function i(e){p(r,a,n,o,i,"throw",e)}o(void 0)}))},function(e,t){return v.apply(this,arguments)})),n),b=a("W6hq");function y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var C,w=/from_\d*_to_\d*/,E=/\d+/g,T=(y(_={},"activePage",(function(e,t,a){var n=a.route;return n.query.page?Number(n.query.page):1})),y(_,"pagesCount",(function(e){return Math.ceil(e.range/9)})),y(_,"activeCategory",(function(e,t,a){var n=a.route.path;return function e(t,a){if(t)for(var n=null,r=null,o=0;o<t.length;o++){if((n=t[o]).code===a)return n;if(r=e(n.items,a))return r}return null}(e.categories,Object(b.b)(n))})),y(_,"routeSegments",(function(e,t,a){var n=a.route.path;return Object(b.c)(n)})),y(_,"filterSegments",(function(e,t){for(var a={},n=t.routeSegments,r=0;r<n.length;r++){var o=n[r],i=o.split("-")[0];if(w.test(o)){var c=o.match(E);a[i]=c.map((function(e){return+e}))}else a[i]||(a[i]={}),a[i][o]=o}return a})),y(_,"activeTags",(function(e,t){for(var a=[],n=e.filters.filter((function(e){return"range"!==e.type})),r=t.filterSegments,o=0;o<n.length;o++)for(var i=n[o],c=0;c<i.items.length;c++){var s=i.items[c];r[i.name]&&r[i.name][s.code]&&a.push(s)}return a})),_);function O(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var A={name:"catalog",namespaced:!0,state:(C={},O(C,"categoryId",null),O(C,"categoryCode",null),O(C,"categories",[]),O(C,"items",[]),O(C,"range",0),O(C,"filters",[{id:1,title:"Цена р.",name:"price",type:"range",max:1e3,min:0},{id:2,title:"Бренды",name:"brand",type:"check",items:[{id:1,name:"L’Oreal Paris",code:"brand-loreal"},{id:2,name:"Maybelline",code:"brand-maybelline"},{id:3,name:"Pupa",code:"brand-pupa"}]},{id:3,title:"Средства",name:"tool",type:"check",values:[],items:[{id:1,name:"Жидкая помада для губ",code:"tool-zhidkaya_pomada_dlya_gub"},{id:2,name:"Помада для губ",code:"tool-pomada_dlya_gub"},{id:3,name:"Гигиеническая помада для губ",code:"tool-gigienicheskaya_pomada_dlya_gub"}]},{id:4,title:"Эффекты",name:"effect",type:"radio",items:[{id:1,name:"Глянцевая",code:"effect-glyancevaya"},{id:2,name:"Матовая",code:"effect-matovaya"},{id:3,name:"Перламутровая",code:"effect-perlamutrovaya"}]}]),C),actions:h,mutations:f,getters:T},S=a("L2JU"),P=a("sEfC"),x=a.n(P);a("4eDr"),a("9bRU");function j(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function k(e,t,a,n,r,o,i){try{var c=e[o](i),s=c.value}catch(e){return void a(e)}c.done?t(s):Promise.resolve(s).then(n,r)}function I(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var o=e.apply(t,a);function i(e){k(o,n,r,i,c,"next",e)}function c(e){k(o,n,r,i,c,"throw",e)}i(void 0)}))}}function $(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$(a,!0).forEach((function(t){F(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function F(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var H,D,M="".concat(A.name,"/").concat("FETCH_CATALOG_DATA"),G=0,L={name:"catalog",components:{VSvg:r.a,VButton:o.a,VSelect:c.a,VPagination:i.a,CatalogFilter:s.a,CatalogProductCard:u.a},data:function(){var e=["Сначала подороже"];return{sortValue:e[0],sortOptions:e}},computed:R({},Object(S.c)(A.name,["activeTags","activeCategory","activePage","pagesCount"]),{},Object(S.d)(A.name,["items"]),{},Object(S.d)("route",{code:function(e){return e.params.code}})),methods:R({},Object(S.b)(A.name,["FETCH_ITEMS","FETCH_CATALOG_DATA"]),{onBeforeEnterItems:function(e){e.dataset.index=G,G+=1,e.style.opacity=0},itemAnimation:function(e,t){return new Promise((function(a,n){try{setTimeout((function(){requestAnimationFrame((function(){e.style.opacity=1,a()}))}),t)}catch(e){n(e)}}))},onEnterItems:(D=I(regeneratorRuntime.mark((function e(t,a){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=100*t.dataset.index,e.next=3,this.itemAnimation(t,n);case 3:a();case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return D.apply(this,arguments)}),onAfterEnterItems:function(e){delete e.dataset.index,G=0},onLeaveItems:function(e,t){requestAnimationFrame((function(){e.style.opacity=0,t()}))},onClickDeleteTag:function(e){var t=this.$route.path.split("/").slice(4);if(t.includes(e)){var a=t.indexOf(e);-1!==a&&t.splice(a,1);var n=t.length>0?"/catalog/".concat(this.code,"/filters"):"/catalog/".concat(this.code);this.$router.replace({path:n.concat.apply(n,j(t.map((function(e){return"/".concat(e)}))))})}}}),beforeRouteEnter:(H=I(regeneratorRuntime.mark((function e(t,a,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.params.code,!!l.$store._modulesNamespaceMap["".concat(A.name,"/")]||l.$store.registerModule(A.name,A,{preserveState:!!l.$store.state.catalog}),l.$store.state.catalog.categoryCode!==r){e.next=8;break}n(),e.next=19;break;case 8:return e.prev=8,l.$progress.start(),e.next=12,l.$store.dispatch(M,{code:r});case 12:n((function(e){return l.$progress.finish()})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(8),l.$progress.fail(),l.$logger.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[8,15]])}))),function(e,t,a){return H.apply(this,arguments)}),beforeRouteUpdate:function(e,t,a){this.debounce_fetchCatalog(e,t),a()},beforeMount:function(){var e=this;this.debounce_fetchCatalog=x()(function(){var t=I(regeneratorRuntime.mark((function t(a,n){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=e.$store.state.catalog.categoryCode,o=a.params.code,e.$progress.start(),r===o){t.next=9;break}return t.next=7,e.FETCH_CATALOG_DATA({code:o});case 7:t.next=11;break;case 9:return t.next=11,e.FETCH_ITEMS({code:o});case 11:e.$progress.finish(),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),l.$logger.error("debounce_fetchCatalog",t.t0),e.$progress.fail();case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,a){return t.apply(this,arguments)}}(),500)}},V=a("KHd+");a.d(t,"DISPATCH_FETCH_CATALOG_DATA",(function(){return M}));var q=Object(V.a)(L,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"section catalog-view"},[e._m(0),e._v(" "),a("section",{staticClass:"section catalog-view__header"},[a("div",{staticClass:"container"},[a("h1",{staticClass:"catalog-view__header-hl"},[e._v(e._s(e.activeCategory?e.activeCategory.name:"Каталог"))]),e._v(" "),a("p",{staticClass:"text-grey catalog-view__header-text"},[e._v("489 товаров")])])]),e._v(" "),a("section",{staticClass:"section"},[a("div",{staticClass:"container catalog-view__grid"},[a("div",{staticClass:"catalog-view__side-panel"},[a("catalog-filter",{staticClass:"catalog-view__side-panel-filters"})],1),e._v(" "),a("div",{staticClass:"catalog-view__main"},[a("transition-group",{staticClass:"catalog-view__main-tags",attrs:{tag:"ul",name:"tag-item"}},e._l(e.activeTags,(function(t,n){return a("li",{key:t.code,staticClass:"catalog-view__main-tags-item",attrs:{"data-index":n}},[e._v("\n                        "+e._s(t.name)+" \n                        "),a("button",{staticClass:"catalog-view__main-tags-delete-btn",on:{click:function(a){return e.onClickDeleteTag(t.code)}}},[a("v-svg",{attrs:{name:"cross-small",width:"24",height:"24"}})],1)])})),0),e._v(" "),a("v-select",{staticClass:"catalog-view__main-sort",attrs:{options:e.sortOptions,searchable:!1,allowEmpty:!1},model:{value:e.sortValue,callback:function(t){e.sortValue=t},expression:"sortValue"}}),e._v(" "),a("transition-group",{staticClass:"catalog-view__main-grid",attrs:{tag:"ul",name:"catalog-item"},on:{"before-enter":e.onBeforeEnterItems,enter:e.onEnterItems,"after-enter":e.onAfterEnterItems,leave:e.onLeaveItems}},e._l(e.items,(function(e){return a("li",{key:e.id,staticClass:"catalog-view__main-grid-item"},[a("catalog-product-card",{staticClass:"catalog-view__main-grid-card",attrs:{"product-id":e.id,name:e.name,href:e.href,image:e.image,price:e.price,"old-price":e.oldPrice,tags:e.tags,rating:e.rating}})],1)})),0),e._v(" "),e.pagesCount>1?a("div",{staticClass:"catalog-view__main-controls"},[e.activePage<e.pagesCount?a("v-button",{staticClass:"btn--outline catalog-view__main-controls-btn",attrs:{to:{path:e.$route.path,query:{page:e.activePage+1}}}},[e._v("\n                        Показать ещё\n                    ")]):e._e(),e._v(" "),a("v-pagination",{attrs:{value:e.activePage,"page-count":e.pagesCount},on:{input:function(t){return e.$router.push({path:e.$route.path,query:{page:t}})}}})],1):e._e()],1)])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("ul",{staticClass:"section catalog-view__breadcrumbs"},[t("li",[this._v("Губная помада")])])])}],!1,null,null,null);t.default=q.exports},"9bRU":function(e,t,a){}}]);