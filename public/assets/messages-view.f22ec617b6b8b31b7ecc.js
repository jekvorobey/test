(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{RIER:function(e,t,n){},hQDq:function(e,t,n){},hyan:function(e,t,n){"use strict";n.r(t);n("7cXU");var a=n("i2Ud"),r=n("KQVR"),s=(n("+gqB"),n("gd5W")),o=n("a6oV"),i=n("SesW"),c=n("L2JU"),u=n("55Sm"),l=n("jDKC"),m=n("rBTT"),f=n("Io6t"),p=n("NqPc"),b=n("2JJK");n("RIER");function d(e,t,n,a,r,s,o){try{var i=e[s](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(a,r)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O="".concat(m.NAME,"/").concat(f.c),_=b.modalName.profile.MESSAGE,y={name:_,mixins:[i.b],components:{VButton:a.a,VInput:r.a,GeneralModal:o.a},validations:{theme:{required:i.h},message:{required:i.h}},data:function(){return{theme:"",message:""}},computed:h(h({},Object(c.d)(u.b,{isOpen:function(e){return e[u.a][b.modalName.profile.MESSAGE]&&e[u.a][b.modalName.profile.MESSAGE].open}})),{},{isTablet:function(){return this.$mq.tablet}}),methods:h(h(h({},Object(c.b)(u.b,[l.a])),Object(c.b)(O,[p.a])),{},{onSubmit:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$v.$invalid){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n=t.$refs.form,a=new FormData(n),e.next=8,t[p.a](a);case 8:t.$emit("created"),t.onClose(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.onClose();case 15:case"end":return e.stop()}}),e,null,[[2,12]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var s=e.apply(t,n);function o(e){d(s,a,r,o,i,"next",e)}function i(e){d(s,a,r,o,i,"throw",e)}o(void 0)}))})()},onClose:function(){this.$emit("close"),this[l.a]({name:_,open:!1})}})},w=n("KHd+"),j=Object(w.a)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isOpen?n("general-modal",{staticClass:"message-modal",attrs:{type:"sm",header:"Новое сообщение","is-mobile":e.isTablet},on:{close:e.onClose},scopedSlots:e._u([{key:"content",fn:function(){return[n("h4",{staticClass:"message-modal__hl"},[e._v("Новое сообщение")]),e._v(" "),n("form",{ref:"form",staticClass:"message-modal__form",attrs:{enctype:"multipart/form-data"},on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[n("v-input",{staticClass:"message-modal__form-row",attrs:{name:"theme",placeholder:"Введите тему"},model:{value:e.theme,callback:function(t){e.theme=t},expression:"theme"}},[e._v("\n                Тема\n            ")]),e._v(" "),n("v-input",{staticClass:"message-modal__form-row message-modal__form-textarea",attrs:{tag:"textarea",placeholder:"Текст сообщения",name:"message",rows:3,"auto-height":!1},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}},[e._v("\n                Сообщение\n            ")]),e._v(" "),n("v-button",{staticClass:"message-modal__submit-btn",on:{click:e.onSubmit}},[e._v("\n                Создать чат\n            ")])],1)]},proxy:!0}],null,!1,1914589501)}):e._e()}),[],!1,null,null,null).exports,S=n("Q2AE"),E=n("3eXy"),P=n("GyY8");n("hQDq");function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $="".concat(m.NAME,"/").concat(f.c),k={name:"messages",components:{VButton:a.a,VInput:r.a,MessageCard:s.a,MessageModal:j},computed:D(D(D(D({},Object(c.d)([S.f])),Object(c.d)($,[f.a])),Object(c.d)(u.b,{isMessageOpen:function(e){return e[u.a][b.modalName.profile.MESSAGE]&&e[u.a][b.modalName.profile.MESSAGE].open}})),{},{chats:function(){var e=this,t=this[f.a]||[];return t.map((function(t){return D(D({},t),{},{date:e.formatDate(t.date)})}))},isTablet:function(){return this.$mq.tablet}}),methods:D(D({},Object(c.b)(u.b,[l.a])),{},{formatDate:function(e){return new Date(e).toLocaleDateString(this[S.f],P.d)},onCreateMessage:function(){this[l.a]({name:b.modalName.profile.MESSAGE,open:!0})},onOpenMessage:function(e){this.$router.push({name:"MessageDetails",params:{chatId:e}})}}),beforeRouteEnter:function(e,t,n){E.$progress.start(),E.$store.dispatch("".concat($,"/").concat(p.b)).then((function(){return n((function(e){return E.$progress.finish()}))})).catch((function(e){return n((function(e){return E.$progress.fail()}))}))}},x=Object(w.a)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"section messages-view"},[n("div",{staticClass:"messages-view__header"},[n("h2",{staticClass:"messages-view__hl"},[e._v(e._s(e.$t("profile.routes."+e.$route.name)))]),e._v(" "),n("v-button",{staticClass:"messages-view__btn",on:{click:e.onCreateMessage}},[e._v("Новое сообщение")])],1),e._v(" "),n("ul",{staticClass:"messages-view__list"},e._l(e.chats,(function(t){return n("message-card",{key:t.id,staticClass:"messages-view__list-item",attrs:{tabindex:"0","message-id":t.id,message:t.message,name:t.name,"last-name":t.lastName,title:t.title,date:t.date,"is-system":t.isSystem,"is-read":t.isRead,"use-header-clamp":!e.isTablet,"use-clamp":""},on:{click:function(n){return n.preventDefault(),e.onOpenMessage(t.id)}}})})),1),e._v(" "),n("transition",{attrs:{name:"fade"}},[e.$isServer||e.isMessageOpen?n("message-modal"):e._e()],1)],1)}),[],!1,null,null,null);t.default=x.exports}}]);