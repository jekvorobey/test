(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"B/pr":function(e,t,s){},o1PI:function(e,t,s){"use strict";s.r(t);var a=s("NDiG"),r=s("7cXU"),n=s("PZpB"),o=s("qjh8"),i=s("9c6q"),d=s("i2Ud"),c=s("0hM7"),u=s("KQVR"),l=s("nurM"),p=s("a6oV"),m=s("L2JU"),f=s("55Sm"),_=s("jDKC"),v=s("SqwP"),h=s("J3J1"),g=(s("9roy"),s("SesW")),b=s("8/qD"),y=s("3eXy"),w=s("Ffxs");s("WW/F"),s("wASK"),s("xtKy");function k(e,t,s,a,r,n,o){try{var i=e[n](o),d=i.value}catch(e){return void s(e)}i.done?t(d):Promise.resolve(d).then(a,r)}function S(e){return function(){var t=this,s=arguments;return new Promise((function(a,r){var n=e.apply(t,s);function o(e){k(n,a,r,o,i,"next",e)}function i(e){k(n,a,r,o,i,"throw",e)}o(void 0)}))}}function x(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function O(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?x(Object(s),!0).forEach((function(t){C(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function C(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var A="address-edit-modal",j={apiKey:"46c69919-a571-416e-8198-189ed26c6a79",lang:"ru_RU",coordorder:"latlong",version:"2.1"},$={name:A,mixins:[g.b],components:{VSvg:a.a,VButton:d.a,VInput:u.a,VSuggestion:c.a,GeneralModal:p.a,RadioSwitch:l.a,yandexMap:i.a,ymapMarker:i.b},validations:{address:{post_index:{required:g.g},flat:{required:g.g},floor:{required:g.g},porch:{required:g.g}}},data:function(){return{address:{country_code:"",post_index:"",region:"",region_guid:"",area:"",area_guid:"",city:"",city_guid:"",street:"",house:"",block:"",flat:"",floor:"",porch:"",intercom:"",comment:"",geo_lat:"",geo_lon:""},coords:null,cities:[],addresses:[],options:{debounce:500},showMap:!1,selectedSwitch:"list",switchItems:[{value:"list",title:"Форма"},{value:"map",title:"Карта"}],markerIcon:{layout:"default#image",imageHref:w.a,imageSize:[24,24],imageOffset:[0,0]}}},computed:O({},Object(m.d)(f.b,{modalState:function(e){return e[f.a][A]&&e[f.a][A].state||{}}}),{},Object(m.c)(v.a,[h.a]),{isTabletLg:function(){return this.$mq.tabletLg},computedCoords:function(){return this.coords||this[h.a]},selectedFormatAddress:function(){var e="";return this.address.street&&(e+=this.address.street+" "),this.address.house&&(e+=this.address.house+" "),this.address.block&&(e+=this.address.block),e},mapSettings:function(){return j},isMap:function(){return"map"===this.selectedSwitch}}),methods:O({},Object(m.b)(f.b,[_.a]),{findAddress:function(e,t,s,a){var r,n={value:e};switch(e){case b.a.REGION:r={value:b.a.AREA};break;case b.a.CITY:r={value:b.a.SETTLEMENT};break;case b.a.STREET:r={value:b.a.STREET};break;case b.a.HOUSE:break;default:r={value:e}}return y.$dadata.post("/suggest/address",{query:t,count:s,locations:a,from_bound:n,to_bound:r})},onCitySelected:function(e){var t=this;return S(regeneratorRuntime.mark((function s(){var a,r;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.findAddress(b.a.CITY,e.unrestricted_value,1);case 3:a=s.sent,r=a.suggestions,t.onApplyAddress(r[0]),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),console.log(s.t0);case 11:case"end":return s.stop()}}),s,null,[[0,8]])})))()},onCityInputChange:function(e){var t=this;return S(regeneratorRuntime.mark((function s(){var a,r;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.findAddress(b.a.CITY,e||t.address.value,20);case 3:a=s.sent,r=a.suggestions,t.cities=r,s.next=12;break;case 8:return s.prev=8,s.t0=s.catch(0),console.log(s.t0),s.abrupt("return",null);case 12:case"end":return s.stop()}}),s,null,[[0,8]])})))()},onAddressSelected:function(e){var t=this;return S(regeneratorRuntime.mark((function s(){var a,r;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.findAddress(b.a.HOUSE,e.unrestricted_value,1);case 3:a=s.sent,r=a.suggestions,t.onApplyAddress(r[0]),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),console.log(s.t0);case 11:case"end":return s.stop()}}),s,null,[[0,8]])})))()},onAddressInputChange:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return S(regeneratorRuntime.mark((function s(){var a,r,n;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,a=[],e.address&&e.address.city_guid&&a.push({city_fias_id:e.address.city_guid}),s.next=5,e.findAddress(b.a.HOUSE,"".concat(e.address.city||""," ").concat(t),20,a);case 5:r=s.sent,n=r.suggestions,e.addresses=n,s.next=14;break;case 10:return s.prev=10,s.t0=s.catch(0),console.log(s.t0),s.abrupt("return",null);case 14:case"end":return s.stop()}}),s,null,[[0,10]])})))()},onMapClick:function(e){var t=this;return S(regeneratorRuntime.mark((function s(){var a,r,n,o;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=e.get("coords"),s.next=3,y.$dadata.post("/geolocate/address",{lat:a[0],lon:a[1],radius_meters:1e3});case 3:r=s.sent,n=r.suggestions,o=n.find((function(e){return e.data.house})),t.onApplyAddress(o);case 7:case"end":return s.stop()}}),s)})))()},formatAddress:function(e){return"".concat(e.data.street_with_type||e.data.city_district_with_type||e.data.settlement_with_type||""," ").concat(e.data.house_type," ").concat(e.data.house," ").concat(e.data.block?"".concat(e.data.block_type," ").concat(e.data.block):"")},onApplyAddress:function(e){var t=O({},this.address);e&&(t.value=e.value,t.country_code=e.data.country_iso_code,e.data.postal_code&&(t.post_index=e.data.postal_code),t.region=e.data.region_with_type||e.data.region,t.region_guid=e.data.region_fias_id,t.area=e.data.area_with_type||e.data.area,t.area_guid=e.data.area_fias_id,t.city=e.data.city_with_type||e.data.city||e.data.settlement_with_type||e.data.settlement,t.city_guid=e.data.city_fias_id||e.data.settlement_fias_id,t.street=e.data.street_with_type||e.data.street,t.house=e.data.house_type?"".concat(e.data.house_type," ").concat(e.data.house):e.data.house,t.block=e.data.block_type?"".concat(e.data.block_type," ").concat(e.data.block):e.data.block,e.data.geo_lat&&e.data.geo_lon&&(t.geo_lat=e.data.geo_lat,t.geo_lon=e.data.geo_lon),this.coords=[Number(e.data.geo_lat),Number(e.data.geo_lon)]||!1,this.address=t)},onSubmit:function(){if(this.$v.$touch(),!this.$v.$invalid){var e=O({},this.address,{porch:String(this.address.porch),floor:String(this.address.floor),flat:String(this.address.flat),post_index:String(this.address.post_index)});this.$emit("save",e),this.onClose()}},onClose:function(){this.CHANGE_MODAL_STATE({name:A,open:!1,state:{address:null,onSave:null}})},init:function(){var e=this;return S(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.modalState.address&&(e.modalState.address.geo_lat&&e.modalState.address.geo_lon&&(e.coords=[Number(e.modalState.address.geo_lat),Number(e.modalState.address.geo_lon)]),e.address=O({},e.modalState.address));case 1:case"end":return t.stop()}}),t)})))()}}),beforeMount:function(){this.init()},mounted:function(){var e=this;setTimeout((function(){return e.showMap=!0}),300)}},P=s("KHd+"),E=Object(P.a)($,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("general-modal",{staticClass:"address-edit-modal",attrs:{type:e.isTabletLg?"fullscreen":"wide","is-mobile":e.isTabletLg},on:{close:e.onClose},scopedSlots:e._u([{key:"content",fn:function(){return[e.isTabletLg?s("radio-switch",{staticClass:"address-edit-modal__switch",attrs:{name:"map-switch",items:e.switchItems},scopedSlots:e._u([{key:"content",fn:function(t){var a=t.item;return[s("v-svg",{attrs:{name:a.value,width:"24",height:"24"}}),e._v("  "+e._s(a.title)+"\n            ")]}}],null,!1,4253381989),model:{value:e.selectedSwitch,callback:function(t){e.selectedSwitch=t},expression:"selectedSwitch"}}):e._e(),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isTabletLg||e.isMap,expression:"!isTabletLg || isMap"}],staticClass:"address-edit-modal__map"},[e.showMap?s("yandex-map",{attrs:{settings:e.mapSettings,coords:e.computedCoords,controls:[],options:{yandexMapDisablePoiInteractivity:!0}},on:{click:e.onMapClick}},[e.coords?s("ymap-marker",{attrs:{"marker-id":"marker-id",coords:e.computedCoords,icon:e.markerIcon}}):e._e()],1):e._e()],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isTabletLg||!e.isMap,expression:"!isTabletLg || !isMap"}],staticClass:"address-edit-modal__form"},[s("div",{staticClass:"address-edit-modal__form-header"},[s("h3",{staticClass:"address-edit-modal__form-header-hl"},[e._v("Адрес доставки")]),e._v(" "),s("span",{staticClass:"text-grey text-sm"},[e._v("Укажите на карте или введите вручную")])]),e._v(" "),s("div",{staticClass:"address-edit-modal__form-row"},[s("v-suggestion",{staticClass:"address-edit-modal__form-column",attrs:{value:e.address.city,options:e.options,items:e.cities},on:{input:e.onCityInputChange,selected:e.onCitySelected},scopedSlots:e._u([{key:"item",fn:function(t){var s=t.item;return[e._v("\n                        "+e._s(s.value)+"\n                    ")]}}])},[e._v("\n                    Ваш населенный пункт\n                    ")]),e._v(" "),s("v-input",{staticClass:"address-edit-modal__form-column address-edit-modal__form-column--30",attrs:{type:"number",maxlength:"6",min:"1"},model:{value:e.address.post_index,callback:function(t){e.$set(e.address,"post_index",t)},expression:"address.post_index"}},[e._v("\n                    Индекс\n                ")])],1),e._v(" "),s("div",{staticClass:"address-edit-modal__form-row"},[s("v-suggestion",{staticClass:"address-edit-modal__form-column",attrs:{value:e.selectedFormatAddress,options:e.options,items:e.addresses},on:{input:e.onAddressInputChange,selected:e.onAddressSelected},scopedSlots:e._u([{key:"item",fn:function(t){var s=t.item;return[e._v("\n                        "+e._s(e.formatAddress(s))+"\n                    ")]}}])},[e._v("\n                    Улица, дом, корпус\n                    ")]),e._v(" "),s("v-input",{staticClass:"address-edit-modal__form-column address-edit-modal__form-column--30",attrs:{type:"number",min:"1"},model:{value:e.address.flat,callback:function(t){e.$set(e.address,"flat",t)},expression:"address.flat"}},[e._v("\n                    Квартира/офис\n                ")])],1),e._v(" "),s("div",{staticClass:"address-edit-modal__form-row"},[s("v-input",{staticClass:"address-edit-modal__form-column address-edit-modal__form-column--30",attrs:{type:"number",min:"1"},model:{value:e.address.floor,callback:function(t){e.$set(e.address,"floor",t)},expression:"address.floor"}},[e._v("\n                    Этаж\n                ")]),e._v(" "),s("v-input",{staticClass:"address-edit-modal__form-column address-edit-modal__form-column--30",attrs:{type:"number",min:"1"},model:{value:e.address.porch,callback:function(t){e.$set(e.address,"porch",t)},expression:"address.porch"}},[e._v("\n                    Подъезд\n                ")]),e._v(" "),s("v-input",{staticClass:"address-edit-modal__form-column address-edit-modal__form-column--30",attrs:{min:"1"},model:{value:e.address.intercom,callback:function(t){e.$set(e.address,"intercom",t)},expression:"address.intercom"}},[e._v("\n                    Домофон\n                ")])],1),e._v(" "),s("v-input",{attrs:{tag:"textarea",rows:"3",maxHeight:"100"},model:{value:e.address.comment,callback:function(t){e.$set(e.address,"comment",t)},expression:"address.comment"}},[e._v("\n                Комментарий курьеру\n            ")]),e._v(" "),s("div",[s("v-button",{staticClass:"address-edit-modal__form-submit",on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v("\n                    Сохранить\n                ")])],1)],1)]},proxy:!0}])})}),[],!1,null,null,null).exports,R=s("rBTT"),T=s("mbF8"),M=s("h9RX"),D=(s("BkRI"),s("Y+p1")),I=s.n(D);s("QmAe"),s("zYMX"),s("B/pr");function q(e,t,s,a,r,n,o){try{var i=e[n](o),d=i.value}catch(e){return void s(e)}i.done?t(d):Promise.resolve(d).then(a,r)}function L(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function N(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?L(Object(s),!0).forEach((function(t){V(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function V(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var H="".concat(R.b,"/").concat(T.b),K={name:"addresses",components:{VSvg:a.a,VLink:r.a,InfoPanel:n.a,CheckoutOptionCard:o.a,AddressEditModal:E},computed:N({},Object(m.d)(H,[T.a]),{},Object(m.d)(f.b,{isAddressEditOpen:function(e){return e[f.a][A]&&e[f.a][A].open}}),{isTablet:function(){return this.$mq.tablet},iconSize:function(){return this.$mq.tablet?24:16}}),methods:N({},Object(m.b)(f.b,[_.a]),{},Object(m.b)(H,[M.b,M.d,M.e,M.c,M.a]),{isEqualAddress:function(e,t){return I()(e,t)},onSetDefaultAddress:function(e){e.default||this[M.c](e.id)},onAddAddress:function(){this[_.a]({name:A,open:!0,state:{address:{}}})},onSaveAddress:function(e){this[M.e](e)},onDeleteAddress:function(e){this[M.a](e)},onChangeAddress:function(e){this[_.a]({name:A,open:!0,state:{address:N({},e)}})}}),serverPrefetch:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t[M.b](t.$isServer);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),y.$logger.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})),function(){var t=this,s=arguments;return new Promise((function(a,r){var n=e.apply(t,s);function o(e){q(n,a,r,o,i,"next",e)}function i(e){q(n,a,r,o,i,"throw",e)}o(void 0)}))})()},beforeRouteEnter:function(e,t,s){if(y.$store.state[R.b][T.b].load)return s(),void y.$store.dispatch("".concat(H,"/").concat(M.d),!1);y.$progress.start(),y.$store.dispatch("".concat(H,"/").concat(M.b)).then((function(){s((function(e){y.$progress.finish()}))})).catch((function(e){y.$progress.fail(),y.$logger.error("beforeRouteEnter",e.error),y.$progress.finish(),s()}))}},U=Object(P.a)(K,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"section addresses-view"},[s("h2",{staticClass:"addresses-view__hl"},[e._v(e._s(e.$t("profile.routes."+e.$route.name)))]),e._v(" "),s("info-panel",{staticClass:"addresses-view__panel",attrs:{header:"Сохраненные адреса"},scopedSlots:e._u([{key:"controls",fn:function(){return[s("v-link",{staticClass:"addresses-view__panel-link",attrs:{tag:"button"},on:{click:e.onAddAddress}},[s("v-svg",{attrs:{name:"plus-small",width:e.iconSize,height:e.iconSize}}),e._v(" "),s("span",[e._v("  Добавить новый адрес")])],1)]},proxy:!0}])},[e._v(" "),s("div",{staticClass:"container container--tablet-lg"},[s("ul",{staticClass:"addresses-view__panel-list"},e._l(e.addresses,(function(t){return s("checkout-option-card",{key:t.region_guid+"-"+(t.city_guid||t.settlment_guid)+"-"+t.house,staticClass:"addresses-view__panel-item",attrs:{selected:t.default},on:{cardClick:function(s){return e.onSetDefaultAddress(t)}},scopedSlots:e._u([{key:"controls",fn:function(){return[s("v-link",{staticClass:"checkout-option-card__right-link",attrs:{tag:"button"},on:{click:function(s){return s.stopPropagation(),e.onChangeAddress(t)}}},[e._v("\n                            Изменить\n                        ")]),e._v(" "),s("v-link",{staticClass:"checkout-option-card__right-link",attrs:{tag:"button"},on:{click:function(s){return s.stopPropagation(),e.onDeleteAddress(t)}}},[e._v("\n                            Удалить\n                        ")])]},proxy:!0}],null,!0)},[e._v("\n                    "+e._s((t.city||t.settlement)+", "+(t.area?t.area+", ":"")+(t.street?t.street+", ":"")+t.house+" "+(t.block||"")+", "+t.post_index)+"\n                    ")])})),1)])]),e._v(" "),s("transition",{attrs:{name:"fade"}},[e.$isServer||e.isAddressEditOpen?s("address-edit-modal",{directives:[{name:"show",rawName:"v-show",value:e.isAddressEditOpen,expression:"isAddressEditOpen"}],on:{save:e.onSaveAddress}}):e._e()],1)],1)}),[],!1,null,null,null);t.default=U.exports},xtKy:function(e,t,s){}}]);