(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{pt7z:function(e,t,a){"use strict";a.r(t);var r=a("NDiG"),i=a("i2Ud"),s=a("jYNS"),n=a("+gqB"),l=a("WYKX"),o=a("7cXU"),c=a("pFko"),_=a("YNzt"),v=a("45Ux"),d=a("KLyl"),u=a("6AGh"),f=a("Z14j"),p=a("uy7R"),m=(a("obii"),a("zfPd"),a("L2JU")),h=a("Q2AE"),b=a("rBTT"),w=a("sJxq"),g=a("iggl"),C=a("AoUT"),y=a("YPqg"),O=a("55Sm"),D=a("jDKC"),F=a("2JJK"),P=a("q5Zp"),j=a("DpYB"),k=a("4mC1"),M=a("GyY8"),S=a("zVjp"),x=a("QmAe"),N=a("aXGN"),$=a("v6zc"),A=a("P1RU"),E=a("3eXy");a("gB8C"),a("yXCv");function q(e,t,a,r,i,s,n){try{var l=e[s](n),o=l.value}catch(e){return void a(e)}l.done?t(o):Promise.resolve(o).then(r,i)}function L(e){return function(){var t=this,a=arguments;return new Promise((function(r,i){var s=e.apply(t,a);function n(e){q(s,r,i,n,l,"next",e)}function l(e){q(s,r,i,n,l,"throw",e)}n(void 0)}))}}function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){V(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function V(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var R="".concat(b.NAME,"/").concat(w.c),B={name:"referal",components:{VSvg:r.a,VButton:i.a,VPicture:s.a,VPagination:n.a,VLink:o.a,VSelect:c.a,VArcCounter:l.a,VChart:function(){return Promise.all([a.e(94),a.e(89)]).then(a.bind(null,"OtNm"))},Price:_.a,InfoRow:v.a,FilterButton:d.a,ShowMoreButton:u.a,AttentionPanel:f.a,MessageModal:p.a},data:function(){var e=[{id:1,title:"Все время",field:j.b.ALL_TIME},{id:2,title:"За год",field:j.b.YEAR},{id:3,title:"За месяц",field:j.b.MONTH},{id:4,title:"За день",field:j.b.DAY}];return{orderFilterValue:e[0],orderFilterOptions:e,isMounted:!1,showMore:!1,chartOptions:T({},S.a)}},computed:T(T(T(T(T(T({},Object(m.d)([h.f])),Object(m.d)(R,[w.b,w.a,w.d])),Object(m.d)(y.c,V({},y.d,(function(e){return e[y.g]&&e[y.g][y.d]||!1})))),Object(m.d)(O.b,{isMessageOpen:function(e){return e[O.a][F.modalName.profile.MESSAGE]&&e[O.a][F.modalName.profile.MESSAGE].open}})),Object(m.c)(R,[C.e,C.f,C.b,C.c,C.d,C.a])),{},{arcSettings:function(){return{start:-120,end:120,activeWidth:16,strokeWidth:16,stroke:"#BDBDBD",activeStroke:"#141116",dashCount:100}},series:function(){return[{name:"Новые рефералы",data:this[C.d]||[]}]},orders:function(){var e=this;return(this[w.b]||[]).map((function(t){var a=t.image&&Object(N.c)(40,40,t.image.id,F.fileExtension.image.WEBP),r=t.image&&Object(N.c)(40,40,t.image.id),i=t.order_date&&new Date(t.order_date).toLocaleDateString(e[h.f],M.b),s=e.$t("referralSource.".concat(t.source));return T(T({},t),{},{qty:Number(t.qty),sourceString:s,date:i,defaultImage:r,desktopImage:a})}))},isTabletLg:function(){return this.$mq.tabletLg},isTablet:function(){return this.$mq.tablet}}),watch:{orderFilterValue:function(e,t){e!==t&&this.$router.replace({path:this.$route.path,query:{orderFilterField:e.field}})}},methods:T(T(T({},Object(m.b)(R,[g.b,g.a,g.d])),Object(m.b)(O.b,[D.a])),{},{onOpenOrder:function(e){this.$router.push({name:"ReferalOrderDetails",params:{referalId:e}})},onShowMore:function(){this.showMore=!0,this.$router.replace({path:this.$route.path,query:T(T({},this.$route.query),{},{page:this[w.a]+1})})},onPageChanged:function(e){this.showMore=!1,this.$router.push({path:this.$route.path,query:T(T({},this.$route.query),{},{page:e})})},formatArcSum:function(e){return"".concat(Object(x.g)(e)," ₽")},shortNumberFormat:function(e){return Object(x.j)(e)},onCopyToClipboard:function(e){var t=Object($.a)(this[y.d]),a=Object(x.i)(t)?"Успешно скопировано":"Не удается скопировать";this[D.a]({name:F.modalName.general.NOTIFICATION,open:!0,state:{message:a}}),e.target.focus()},onPromocodeRequest:function(){this[D.a]({name:F.modalName.profile.MESSAGE,open:!0,state:{themeCode:F.themeCodes.PROMOCODE}})},onChatCreated:function(){this[D.a]({name:F.modalName.general.NOTIFICATION,open:!0,state:{title:"Уведомление",message:"Запрос отправлен, администратор свяжется с вами в ближайшее время."}})},setOrderFilterValue:function(e){this.orderFilterValue=this.orderFilterOptions.find((function(t){return t.field===e}))||this.orderFilterOptions[0]}}),serverPrefetch:function(){var e=this;return L(regeneratorRuntime.mark((function t(){var a,r,i,s,n,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a=e.$route,r=a.fullPath,i=a.query,s=i.page,void 0===s?k.b:s,n=i.orderField,void 0===n?P.g.NAME:n,l=i.orderDirection,void 0===l?F.sortDirections.DESC:l,e[g.d](r)}catch(e){E.$logger.error(e)}case 1:case"end":return t.stop()}}),t)})))()},beforeRouteEnter:function(e,t,a){var r=e.fullPath,i=e.query,s=i.page,n=void 0===s?k.b:s,l=i.orderField,o=void 0===l?P.g.NAME:l,c=i.orderDirection,_=void 0===c?F.sortDirections.DESC:c,v=i.orderFilterField,d=E.$store.state[b.NAME][w.c].loadPath,u=Object(A.b)(v);d===r?a():(E.$progress.start(),E.$store.dispatch("".concat(R,"/").concat(g.b),{page:n,orderField:o,orderDirection:_,orderFilterField:v,date:u}).then((function(){a((function(e){e.setOrderFilterValue(v),E.$progress.finish()}))})).catch((function(e){E.$progress.fail(),a()})))},beforeRouteUpdate:function(e,t,a){var r=this;return L(regeneratorRuntime.mark((function t(){var i,s,n,l,o,c,_,v,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.fullPath,i=e.query,s=i.page,n=void 0===s?k.b:s,l=i.orderField,o=void 0===l?P.g.NAME:l,c=i.orderDirection,_=void 0===c?F.sortDirections.DESC:c,v=i.orderFilterField,d=Object(A.b)(v),t.prev=2,r.$progress.start(),t.next=6,r[g.a]({page:n,orderField:o,orderDirection:_,showMore:r.showMore,orderFilterField:v,date:d});case 6:r.setOrderFilterValue(v),r.$progress.finish(),a(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),r.$progress.fail(),a(!1);case 15:r.showMore=!1;case 16:case"end":return t.stop()}}),t,null,[[2,11]])})))()},beforeMount:function(){Object(A.b)(this.orderFilterValue)},mounted:function(){this.isMounted=!0}},Y=a("KHd+"),z=Object(Y.a)(B,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"section referal-view"},[a("h2",{staticClass:"referal-view__hl"},[e._v(e._s(e.$t("profile.routes."+e.$route.name)))]),e._v(" "),e.referralData&&e.level?a("div",{staticClass:"referal-view__panels"},[a("div",{staticClass:"referal-view__panel"},[a("div",{staticClass:"referal-view__panel-item"},[a("div",{staticClass:"text-grey referal-view__panel-name"},[e._v("Ваш уровень")]),e._v(" "),a("div",{staticClass:"referal-view__panel-level"},[e._v(e._s(e.levelData.currentLevelName))])]),e._v(" "),e.levelData.nextLevelName||!e.levelData.nextLevelName&&e.isTabletLg&&!e.isTablet?a("div",{staticClass:"referal-view__panel-item",style:{visibility:e.levelData.nextLevelName?"visible":"hidden"}},[a("div",{staticClass:"text-grey referal-view__panel-name"},[e._v("\n                    Следующий уровень\n                ")]),e._v(" "),a("div",{staticClass:"text-grey referal-view__panel-level"},[e._v(e._s(e.levelData.nextLevelName))])]):e._e(),e._v(" "),a("a",{staticClass:"referal-view__panel-link"},[e._v("Подробнее о реферальной программе")])]),e._v(" "),a("div",{staticClass:"referal-view__panel",class:{"referal-view__panel--empty":!e.levelData.nextLevelName}},[e.levelData.nextLevelName?[a("div",{staticClass:"referal-view__panel-item"},[a("div",{staticClass:"referal-view__panel-item-counter"},[a("v-arc-counter",e._b({attrs:{text:e.referralArcData.value,"active-count":e.referralArcData.currentPercent}},"v-arc-counter",e.arcSettings,!1)),e._v(" "),a("div",{staticClass:"text-grey referal-view__panel-item-label"},[a("span",[e._v("0")]),e._v(" "),a("span",[e._v(e._s(e.referralArcData.next))])])],1),e._v(" "),a("div",{staticClass:"text-grey"},[e._v("Новых рефералов")])]),e._v(" "),a("div",{staticClass:"referal-view__panel-item"},[a("div",{staticClass:"referal-view__panel-item-counter"},[a("v-arc-counter",e._b({attrs:{text:e.formatArcSum(e.sumArcData.value),"active-count":e.sumArcData.currentPercent}},"v-arc-counter",e.arcSettings,!1)),e._v(" "),a("div",{staticClass:"text-grey referal-view__panel-item-label"},[a("span",[e._v("0")]),e._v(" "),a("span",[e._v(e._s(e.shortNumberFormat(e.sumArcData.next)))])])],1),e._v(" "),a("div",{staticClass:"text-grey"},[e._v("Сумма заказов")])])]:a("div",{staticClass:"referal-view__panel-item"},[a("h2",[e._v("Поздравляем!")]),e._v("\n                Вы достигли максимального уровня!\n            ")])],2)]):e._e(),e._v(" "),e.orders&&e.orders.length?[a("section",{staticClass:"referal-view__section referal-view__graph"},[a("h3",{staticClass:"container container--tablet-lg referal-view__section-hl"},[e._v("Новые рефералы")]),e._v(" "),e.isMounted?a("v-chart",{attrs:{type:"line",options:e.chartOptions,series:e.series,height:"350px"}}):e._e()],1),e._v(" "),a("div",{staticClass:"container container--tablet-lg"},[a("section",{staticClass:"referal-view__section"},[a("div",{staticClass:"referal-view__section-header"},[a("h3",{staticClass:"referal-view__section-hl"},[e._v("История заказов рефералов")]),e._v(" "),e.isTabletLg?e._e():a("v-select",{staticClass:"referal-view__section-filter",attrs:{label:"title","track-by":"id",options:e.orderFilterOptions,searchable:!1,"allow-empty":!1,"show-labels":!1},model:{value:e.orderFilterValue,callback:function(t){e.orderFilterValue=t},expression:"orderFilterValue"}})],1),e._v(" "),e.isTabletLg?e._e():a("table",{staticClass:"referal-view__table"},[e._m(0),e._v(" "),e._m(1),e._v(" "),a("transition-group",{staticClass:"referal-view__table-body",attrs:{tag:"tbody",name:"fade-in",appear:""}},e._l(e.orders,(function(t){return a("tr",{key:t.id,staticClass:"referal-view__table-tr"},[a("td",{staticClass:"referal-view__table-td"},[a("div",{staticClass:"referal-view__table-img",class:{"referal-view__table-img--empty":!t.image||!t.image.id}},[t.image&&t.image.id?a("v-picture",{key:t.image.id},[a("source",{attrs:{"data-srcset":t.desktopImage,type:"image/webp"}}),e._v(" "),a("img",{staticClass:"blur-up lazyload v-picture__img",attrs:{"data-src":t.defaultImage}})]):a("v-svg",{attrs:{name:"logo",width:"32",height:"32"}})],1),e._v(" "),a("div",{staticClass:"referal-view__table-title"},[e._v("\n                                    "+e._s(t.name)+"\n                                ")])]),e._v(" "),a("td",{staticClass:"referal-view__table-td"},[e._v(e._s(t.qty)+" шт")]),e._v(" "),a("td",{staticClass:"referal-view__table-td"},[a("router-link",{attrs:{to:{name:"ReferalOrderDetails",params:{referalId:t.customer_id}}}},[e._v("\n                                    "+e._s(t.customer_id)+"\n                                ")])],1),e._v(" "),a("td",{staticClass:"referal-view__table-td"},[e._v("\n                                "+e._s(t.sourceString)+"\n                            ")]),e._v(" "),a("td",{staticClass:"referal-view__table-td"},[e._v(e._s(t.date))]),e._v(" "),a("td",{staticClass:"referal-view__table-td"},[a("price",e._b({},"price",t.price_product,!1))],1),e._v(" "),a("td",{staticClass:"referal-view__table-td"},[a("price",e._b({},"price",t.price_commission,!1))],1)])})),0)],1)]),e._v(" "),e.isTabletLg?a("filter-button",{staticClass:"referal-view__filter-btn",on:{click:function(t){e.filterModal=!e.filterModal}}},[e._v("\n                Фильтр и сортировка  \n                "),a("span",{staticClass:"text-grey"},[e._v("4")])]):e._e()],1),e._v(" "),e.isTabletLg?a("ul",{staticClass:"referal-view__list"},e._l(e.orders,(function(t){return a("li",{key:t.id,staticClass:"referal-view__list-item"},[a("info-row",{staticClass:"referal-view__list-item-row",attrs:{name:"Товар"}},[a("div",{staticClass:"referal-view__table-img",class:{"referal-view__table-img--empty":!t.image||!t.image.id}},[t.image&&t.image.id?a("v-picture",{key:t.image.id},[a("source",{attrs:{"data-srcset":t.desktopImage,type:"image/webp"}}),e._v(" "),a("img",{staticClass:"blur-up lazyload v-picture__img",attrs:{"data-src":t.defaultImage}})]):a("v-svg",{attrs:{name:"logo",width:"32",height:"32"}})],1),e._v(" "),a("div",{staticClass:"referal-view__table-title"},[e._v("\n                        "+e._s(t.name)+"\n                    ")])]),e._v(" "),a("info-row",{staticClass:"referal-view__list-item-row",attrs:{name:"Количество"}},[e._v(" "+e._s(t.qty)+" шт. ")]),e._v(" "),a("info-row",{staticClass:"referal-view__list-item-row",attrs:{name:"ID реферала"}},[a("router-link",{attrs:{to:{name:"ReferalOrderDetails",params:{referalId:t.customer_id}}}},[e._v("\n                        "+e._s(t.customer_id)+"\n                    ")])],1),e._v(" "),a("info-row",{staticClass:"referal-view__list-item-row",attrs:{name:"Источник",value:t.sourceString}}),e._v(" "),a("info-row",{staticClass:"referal-view__list-item-row",attrs:{name:"Дата заказа",value:t.date}}),e._v(" "),a("info-row",{staticClass:"referal-view__list-item-row",attrs:{name:"Сумма"}},[a("price",e._b({},"price",t.price_product,!1))],1),e._v(" "),a("info-row",{staticClass:"referal-view__list-item-row",attrs:{name:"Сумма вознаграждения"}},[a("price",e._b({},"price",t.price_commission,!1))],1)],1)})),0):e._e()]:a("attention-panel",{staticClass:"referal-view__attention-panel"},[a("div",{staticClass:"referal-view__attention-section"},[a("p",{staticClass:"referal-view__attention-text"},[e._v("\n                Вам еще не начислялись вознаграждения за покупки рефералов. Воспользуйтесь одним из маркетинговых\n                инструменов для привлечения аудитории:\n            ")]),e._v(" "),a("ul",{staticClass:"list list--dashed referal-view__attention-list"},[a("li",{staticClass:"referal-view__attention-list-item"},[a("v-link",{staticClass:"referal-view__attention-link",attrs:{tag:"button"},on:{click:function(t){return e.onCopyToClipboard(t)}}},[e._v("\n                        скопировать\n                    ")]),e._v("\n                    реферальную ссылку и разместить её в соцсетях\n                ")],1),e._v(" "),a("li",{staticClass:"referal-view__attention-list-item"},[e._v("\n                    собрать собственную\n                    "),a("v-link",{staticClass:"referal-view__attention-link",attrs:{tag:"button",to:{name:"Promopage"}}},[e._v("\n                        промо-страницу\n                    ")]),e._v("\n                    с товарами\n                ")],1),e._v(" "),a("li",{staticClass:"referal-view__attention-list-item"},[a("button",{staticClass:"referal-view__attention-link",on:{click:e.onPromocodeRequest}},[e._v("\n                        запросить\n                    ")]),e._v("\n                    промо-код\n                ")]),e._v(" "),a("li",{staticClass:"referal-view__attention-list-item"},[a("v-link",{staticClass:"referal-view__attention-link",attrs:{tag:"button",to:{name:"Seo"}}},[e._v("\n                        расшарить\n                    ")]),e._v("\n                    товары для продвижения\n                ")],1)])])]),e._v(" "),e.pagesCount>1?a("div",{staticClass:"container container--tablet-lg referal-view__controls"},[e.activePage<e.pagesCount?a("show-more-button",{attrs:{"btn-class":"btn--outline referal-view__controls-btn","show-preloader":e.showMore},on:{click:function(t){return t.preventDefault(),e.onShowMore(t)}}},[e._v("\n            Показать ещё\n        ")]):e._e(),e._v(" "),a("v-pagination",{attrs:{value:e.activePage,"page-count":e.pagesCount},on:{input:e.onPageChanged}})],1):e._e(),e._v(" "),a("transition",{attrs:{name:"fade"}},[e.$isServer||e.isMessageOpen?a("message-modal",{on:{created:e.onChatCreated}}):e._e()],1)],2)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("colgroup",[t("col",{attrs:{width:"40%"}}),this._v(" "),t("col",{attrs:{width:"12%"}}),this._v(" "),t("col",{attrs:{width:"12%"}}),this._v(" "),t("col",{attrs:{width:"12%"}}),this._v(" "),t("col",{attrs:{width:"12%"}}),this._v(" "),t("col",{attrs:{width:"12%"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",{staticClass:"referal-view__table-head"},[a("tr",{staticClass:"referal-view__table-tr referal-view__table-tr--header"},[a("th",{staticClass:"referal-view__table-th"},[e._v("Товар")]),e._v(" "),a("th",{staticClass:"referal-view__table-th"},[e._v("Количество")]),e._v(" "),a("th",{staticClass:"referal-view__table-th"},[e._v("ID реферала")]),e._v(" "),a("th",{staticClass:"referal-view__table-th"},[e._v("Источник")]),e._v(" "),a("th",{staticClass:"referal-view__table-th"},[e._v("Дата заказа")]),e._v(" "),a("th",{staticClass:"referal-view__table-th"},[e._v("Сумма")]),e._v(" "),a("th",{staticClass:"referal-view__table-th"},[e._v("Сумма вознаграждения")])])])}],!1,null,null,null);t.default=z.exports},yXCv:function(e,t,a){}}]);