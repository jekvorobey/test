<!DOCTYPE html>
<html lang="en">

<head>
    <title>{{ title }}</title>
    <meta charset="utf-8" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-progress-style" content="default" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="msapplication-TileColor" content="#141116" />
    <meta name="theme-color" content="#141116" /> {{{render.meta && render.meta()}}}
    <meta name="yandex-verification" content="1d01b5c7b060600a" />
    <meta property="fb:app_id" content="663553691016097" />
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/images/icons/logo-120.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icons/apple-touch-icon.png" />
    <link rel="mask-icon" href="/assets/images/icons/safari-pinned-tab.svg" />
    <link rel="manifest" href="/assets/site.webmanifest" />
    <link rel="preconnect" href="https://tracking.retailrocket.net" />
    <link rel="preconnect" href="https://www.google.ru" />
    <link rel="preconnect" href="https://cdn.retailrocket.ru" /> {{{render.link && render.link()}}} {{{ renderResourceHints() }}} {{{ renderStyles() }}}

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WQJNN4L');</script>
    <!-- End Google Tag Manager -->

    <script>
        var rrPartnerId = '5eaaa38e97a5251ce0bd43ba'
        var rrApi = {}
        var rrApiOnReady = rrApiOnReady || []
        rrApi.addToBasket = rrApi.order = rrApi.categoryView = rrApi.view = rrApi.recomMouseDown = rrApi.recomAddToCart = function() {};
        (function(d) {
            var ref = d.getElementsByTagName('script')[0]
            var apiJs,
                apiJsId = 'rrApi-jssdk'
            if (d.getElementById(apiJsId)) return
            apiJs = d.createElement('script')
            apiJs.id = apiJsId
            apiJs.async = true
            apiJs.src = '//cdn.retailrocket.ru/content/javascript/tracking.js'
            ref.parentNode.insertBefore(apiJs, ref)
        })(document)
    </script>
</head>

<body>
    <!--vue-ssr-outlet-->
    {{{ renderState() }}} {{{ renderScripts() }}}

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WQJNN4L"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <script defer>
        (function() {
            window.frisbuy = window.frisbuy || {};
            window.frisbuy.log = function(t, e, i) {
                var o = localStorage.getItem('frb.log.heap');
                (o = (o && JSON.parse(o)) || []),
                o.push({
                        msg: t,
                        name: e,
                        severity: i,
                        time: Date.now()
                    }),
                    localStorage.setItem('frb.log.heap', JSON.stringify(o));
            };

            window.frisbuy.loadScript = function(t, e, i) {
                var o = 0,
                    r = function(n) {
                        var a = document.createElement('script');
                        a.setAttribute('defer', 'defer');
                        n && frisbuy.log({
                                url: t,
                                attemptLimit: o
                            }, 'load.widget', 'high'),
                            o >= e ||
                            (i && (a.onload = i),
                                (a.onerror = r),
                                (a.src = t),
                                setTimeout(function() {
                                    document.body.appendChild(a);
                                }, 15 * Math.pow(10, o) * o),
                                o++);
                        return a;
                    };
                e = e || 3;
                return r();
            };
        })();
    </script>

    <!-- {literal} -->
    <script defer>
        var liveTex = true,
            liveTexID = 163659,
            liveTex_object = true;
        var pagesForExclude = ['/cart/', '/checkout/'];

        var isDisabled = function(pages) {
            var currentPage = document.location.href;
            var accum = true;
            pages.forEach(function(e) {
                if (currentPage.indexOf(e) !== -1) {
                    accum = false;
                }
            });
            return accum;
        };
        var LiveTex = {
            onLiveTexReady: function() {
                if ((window.location.pathname == '/') || (isDisabled(pagesForExclude) == 0)) {
                    setTimeout(() => {
                        let selectors = ['.lt-label-mobile', '.lt-label', '.lt-widget-wrap', '.lt-xbutton-main-wrapper', '.lt-xbutton']
                        selectors.forEach(selector => {
                            if(document.querySelector(selector)) {
                                document.querySelector(selector).setAttribute('style', 'display: block');
                            }
                        })
                    }, 1000)
                }
            }
        };
        (function() {
            var lt = document.createElement('script');
            lt.type = 'text/javascript';
            lt.async = true;
            lt.src = '//cs15.livetex.ru/js/client.js';
            document.body.appendChild(lt);
        })();
    </script>
    <!-- {/literal} -->

    <script>
        /*
        * Данный скрипт призван поправить неточности и баги в виджете от liveTex ("Заказать обратный звонок")
        * */
        window.onload = function () {
            try {
                // Получаем все src элементов script на странице
                let scriptSrcArray = [];
                document.querySelectorAll('script').forEach(script => scriptSrcArray.push(script.src));

                // Если LiveTex скрипт есть на странице
                if (scriptSrcArray.includes('http://cs15.livetex.ru/js/client.js')) {

                    // Ожидаем прогрузки всех скриптов LiveTex
                    setTimeout(function () {

                        // Открываем окно чата
                        document.querySelector('.lt-label').addEventListener('click', function () {
                            // Закзать звонок
                            document.querySelector('.call-request').addEventListener('click', function () {
                                // Получаем все label относящиеся к вводу телефона на странице
                                let phoneLabels = document.querySelectorAll('.lt-i-label.lt-i-label-phone')

                                // На каждый input телефона вешаем слушатель
                                document.querySelectorAll('.lt-i-label__input.lt-complaint-phone-input').forEach(input => {
                                    /*
                                    * Проверяем если есть ошибка и инпут не пустой то label скрываем
                                    * если e.target.value.length === 18 (введен правильный телефон) то label так же скрываем
                                    * */
                                    input.addEventListener('blur', function (e) {
                                        phoneLabels.forEach(label => {
                                            if (e.target.value.length > 0 && label.classList.contains('lt-error') || e.target.value.length === 18) {
                                                document.querySelectorAll('div[title="Телефон"]').forEach(phone => phone.style.display = 'none')
                                            } else {
                                                document.querySelectorAll('div[title="Телефон"]').forEach(phone => phone.style.display = 'block')
                                            }
                                        })
                                    })

                                    // На каждый label телефона вешаем событие - скрыть при клике
                                    phoneLabels.forEach(label => {
                                        label.addEventListener('click', function () {
                                            document.querySelectorAll('div[title="Телефон"]').forEach(phone => phone.style.display = 'none')
                                        })
                                    })
                                })

                                // При открытие календаря скрываем левую стрелку
                                document.querySelector('.lt-datepicker').addEventListener('click', function () {
                                    document.querySelector('.lt-ui-icon-circle-triangle-w').style.display = 'none';
                                })
                            })
                        })
                    }, 4000)
                }
            } catch (error) {
                console.log('liveTex error: ', error)
            }
        };
    </script>
</body>

</html>
